# 1、uni-app简介

#### 1、简介

**uni-app 是一个使用 Vue.js 开发所有前端应用的框架**。开发者编写一套代码，可发布到 iOS、Android、

H5、以及各种小程序（微信/支付宝/百度/头条/QQ/钉钉/淘宝）、快应用等多个平台。 

![1648020648242](C:\Users\86186\AppData\Roaming\Typora\typora-user-images\1648020648242.png)

#### 2、开发工具

uni-app 官方推荐使用 **HBuilderX** 来开发 uni-app 类型的项目。主要好处：

- 模板丰富
- 完善的智能提示
- 一键运行

#### 3、安装 scss/sass 编译

为了方便编写样式（例如：``），建议安装 `scss/sass 编译` 插件。插件下载地址：

> https://ext.dcloud.net.cn/plugin?name=compile-node-sass

进入插件下载页面之后，点击右上角的 `使用 HBuilderX 导入插件` 按钮进行自动安装，截图如下：

 ![img](https://www.escook.cn/docs-uni-shop/assets/img/1-1.74fed64c.png) 

#### 目录结构

```text
┌─components            uni-app组件目录
│  └─comp-a.vue         可复用的a组件
├─pages                 业务页面文件存放的目录
│  ├─index
│  │  └─index.vue       index页面
│  └─list
│     └─list.vue        list页面
├─static                存放应用引用静态资源（如图片、视频等）的目录，注意：静态资源只能存放于此
├─main.js               Vue初始化入口文件
├─App.vue               应用配置，用来配置小程序的全局样式、生命周期函数等
├─manifest.json         配置应用名称、appid、logo、版本等打包信息
└─pages.json            配置页面路径、页面窗口样式、tabBar、navigationBar 等页面类信息
```

#####  把项目运行到微信开发者工具

1.填写自己的微信小程序AppID：

![img](https://www.escook.cn/docs-uni-shop/assets/img/1-8.4c14eb68.png) 2. 在 HBuilderX 中，配置“微信开发者工具”的**安装路径**： 

![img](https://www.escook.cn/docs-uni-shop/assets/img/1-9.deca7c09.png) 

3. 在微信开发者工具中，通过 `设置 -> 安全设置` 面板，开启“微信开发者工具”的**服务端口**： 

 ![img](data:image/png;base64,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) 

4. 在 HBuilderX 中，点击菜单栏中的 `运行 -> 运行到小程序模拟器 -> 微信开发者工具`，将当前 uni-app 项目编

   译之后，自动运行到微信开发者工具中，从而方便查看项目效果与调试： 

 ![img](https://www.escook.cn/docs-uni-shop/assets/img/1-11.2637002b.png) 

5. 初次运行成功之后的项目效果： 

![1648023498295](C:\Users\86186\AppData\Roaming\Typora\typora-user-images\1648023498295.png)

## 1、使用Git管理项目

#### 1、本地管理

1. 在项目根目录中新建 `.gitignore` 忽略文件，并配置如下：

   ```text
   # 忽略 node_modules 目录
   /node_modules
   /unpackage/dist
   ```

   > 注意：由于我们忽略了 unpackage 目录中**仅有的** dist 目录，因此默认情况下， unpackage 目录不会被 Git 追踪

   > 此时，为了让 Git 能够正常追踪 unpackage 目录，按照惯例，我们可以在 unpackage 目录下创建一个叫做 `.gitkeep` 的文件进行占位

2. 打开终端，切换到项目根目录中，运行如下的命令，初始化本地 Git 仓库：

```bash
git init
```

3.将所有文件都加入到暂存区：

```
git add .
```

4.本地提交更新

~~~
git commit -m "init project"
~~~

查看状态

~~~
git status
~~~

##### 2、把项目托管到码云

1. 注册并激活码云账号（ 注册页面地址：https://gitee.com/signup ）

2. 生成并配置 SSH 公钥（运行 ssh -t git@gitee.com 检测SSH公钥是否配置成功）

   cmd中ssh wyb(为服务器取的别名)

3. 创建空白的码云仓库

4. 把本地项目上传到码云对应的空白仓库中

# 2、tabBar

#### 1、创建 tabBar 分支

1、运行如下的命令，基于 master 分支在本地创建 tabBar 子分支，用来开发和 tabBar 相关的功能： 

```bash
git checkout -b tabbar
```

2、创建 tabBar 页面

在 `pages` 目录中，创建首页(home)、分类(cate)、购物车(cart)、我的(my) 这 4 个 tabBar 页面。在 HBuilderX 

中，可以通过如下的两个步骤，快速新建页面：

1. 在 `pages` 目录上鼠标右键，选择**新建页面**
2. 在弹出的窗口中，填写**页面的名称**、**勾选 scss 模板**之后，点击创建按钮。截图如下：

 ![img](https://www.escook.cn/docs-uni-shop/assets/img/2-1.a57d1b5c.png) 

**格式化快捷键：shift+alt+f**

#### 2、配置tabBar效果

1. 将 `资料` 目录下的 `static 文件夹` 拷贝一份，替换掉项目根目录中的 `static 文件夹`
2. 修改项目根目录中的 `pages.json` 配置文件，新增 `tabBar` 的配置节点如下：

```json
{
  "tabBar": {
    "selectedColor": "#C00000",
    "list": [
      {
        "pagePath": "pages/home/home",
        "text": "首页",
        "iconPath": "static/tab_icons/home.png",
        "selectedIconPath": "static/tab_icons/home-active.png"
      },
      {
        "pagePath": "pages/cate/cate",
        "text": "分类",
        "iconPath": "static/tab_icons/cate.png",
        "selectedIconPath": "static/tab_icons/cate-active.png"
      },
      {
        "pagePath": "pages/cart/cart",
        "text": "购物车",
        "iconPath": "static/tab_icons/cart.png",
        "selectedIconPath": "static/tab_icons/cart-active.png"
      },
      {
        "pagePath": "pages/my/my",
        "text": "我的",
        "iconPath": "static/tab_icons/my.png",
        "selectedIconPath": "static/tab_icons/my-active.png"
      }
    ]
  }
}
```

#### 3、删除默认的 index 首页

1. 在 HBuilderX 中，把 `pages` 目录下的 `index首页文件夹` 删除掉
2. 同时，把 `page.json` 中记录的 `index 首页` 路径删除掉
3. 为了防止小程序运行失败，在微信开发者工具中，手动删除 `pages` 目录下的 `index 首页文件夹`
4. 同时，把 `components` 目录下的 `uni-link 组件文件夹` 删除掉

#### 4、修改导航条的样式效果

1. 打开 `pages.json` 这个全局的配置文件
2. 修改 `globalStyle` 节点如下：

```json
{
  "globalStyle": {
    "navigationBarTextStyle": "white",
    "navigationBarTitleText": "黑马优购",
    "navigationBarBackgroundColor": "#C00000",
    "backgroundColor": "#FFFFFF"
  }
}
```

#### 5、分支的提交与合并

1. 将本地的 tabbar 分支进行本地的 commit 提交：

   ```bash
   git add .
   git commit -m "完成了 tabBar 的开发"
   ```

2. 将本地的 tabbar 分支推送到远程仓库进行保存：

   ```bash
   git push -u origin tabbar
   ```

3. 将本地的 tabbar 分支合并到本地的 master 分支：

   ```bash
   git checkout master
   git merge tabbar
   ```

4. 删除本地的 tabbar 分支：

   ```bash
   git branch -d tabbar
   ```

# 3、首页

#### 1、创建home分支

运行如下的命令，基于 master 分支在本地创建 home 子分支，用来开发和 home 首页相关的功能： 

```bash
git checkout -b home
```

##### 1.1 配置网络请求

由于平台的限制，小程序项目中**不支持 axios**，而且原生的 `wx.request()` API 功能较为简单，**不支持拦截器**

等全局定制的功能。因此，建议在 uni-app 项目中使用 **`@escook/request-miniprogram`** 第三方包发起网络数

据请求。 

> 请参考 **@escook/request-miniprogram** 的官方文档进行安装、配置、使用

> 官方文档：https://www.npmjs.com/package/@escook/request-miniprogram

最终，在项目的 `main.js` 入口文件中，通过如下的方式进行配置： 

```js
import { $http } from '@escook/request-miniprogram'

uni.$http = $http
// 配置请求根路径
$http.baseUrl = 'https://www.uinav.com'

// 请求开始之前做一些事情
$http.beforeRequest = function (options) {
  uni.showLoading({
    title: '数据加载中...',
  })
}

// 请求完成之后做一些事情
$http.afterRequest = function () {
  uni.hideLoading()
}
```

#### 2、轮播图区域

##### 2.1 请求轮播图的数据

实现步骤：

1. 在 data 中定义轮播图的数组
2. 在 onLoad 生命周期函数中调用获取轮播图数据的方法
3. 在 methods 中定义获取轮播图数据的方法

示例代码：

```js
export default {
  data() {
    return {
      // 1. 轮播图的数据列表，默认为空数组
      swiperList: [],
    }
  },
  onLoad() {
    // 2. 在小程序页面刚加载的时候，调用获取轮播图数据的方法
    this.getSwiperList()
  },
  methods: {
    // 3. 获取轮播图数据的方法
    async getSwiperList() {
      // 3.1 发起请求
      const { data: res } = await uni.$http.get('/api/public/v1/home/swiperdata')
      // 3.2 请求失败
      if (res.meta.status !== 200) {
        return uni.showToast({
          title: '数据请求失败！',
          duration: 1500,
          icon: 'none',
        })
      }
      // 3.3 请求成功，为 data 中的数据赋值
      this.swiperList = res.message
    },
  },
}
```

##### 2.2 渲染轮播图的 UI 结构

1.  渲染 UI 结构： 

```xml
<template>
  <view>
    <!-- 轮播图区域 -->
    <swiper :indicator-dots="true" :autoplay="true" :interval="3000" :duration="1000" :circular="true">
      <!-- 循环渲染轮播图的 item 项 -->
      <swiper-item v-for="(item, i) in swiperList" :key="i">
        <view class="swiper-item">
          <!-- 动态绑定图片的 src 属性 -->
          <image :src="item.image_src"></image>
        </view>
      </swiper-item>
    </swiper>
  </view>
</template>
```

2. 美化UI样式

```scss
<style lang="scss">
swiper {
 height: 330rpx;

 .swiper-item,
 image {
   width: 100%;
   height: 100%;
 }
}
</style>
```

##### 2.3 配置小程序分包

 **分包可以减少小程序首次启动时的加载时间** 

为此，我们在项目中，把 tabBar 相关的 4 个页面放到主包中，其它页面（例如：商品详情页、商品列表页）

放到分包中。在 uni-app 项目中，配置分包的步骤如下：

1. 在项目根目录中，创建分包的根目录，命名为 `subpkg`
2. 在 `pages.json` 中，和 `pages` 节点平级的位置声明 `subPackages` 节点，用来定义分包相关的结构：

```json
{
  "pages": [
    {
      "path": "pages/home/home",
      "style": {}
    },
    {
      "path": "pages/cate/cate",
      "style": {}
    },
    {
      "path": "pages/cart/cart",
      "style": {}
    },
    {
      "path": "pages/my/my",
      "style": {}
    }
  ],
  "subPackages": [
    {
      "root": "subpkg",
      "pages": []
    }
  ]
}
```

3. 在 `subpkg` 目录上鼠标右键，点击 `新建页面` 选项，并填写页面的相关信息：

 ![img](https://www.escook.cn/docs-uni-shop/assets/img/2-2.e5e761c8.png) 

##### 2.4 点击轮播图跳转到商品详情页面

 将 swiper-item 节点内的 `view` 组件，改造为 `navigator` 导航组件，并动态绑定 `url 属性` 的值。 

1. 改造之前的 UI 结构：

```xml
<swiper-item v-for="(item, i) in swiperList" :key="i">
  <view class="swiper-item">
    <!-- 动态绑定图片的 src 属性 -->
    <image :src="item.image_src"></image>
  </view>
</swiper-item>
```

2. 改造之后的UI结构

```xml
<swiper-item v-for="(item, i) in swiperList" :key="i">
    <navigator class="swiper-item" :url="'/subpkg/goods_detail/goods_detail?goods_id=' + item.goods_id">
      <!-- 动态绑定图片的 src 属性 -->
      <image :src="item.image_src"></image>
    </navigator>
</swiper-item>
```

##### 2.5 封装 uni.$showMsg() 方法

当数据请求失败之后，经常需要调用 `uni.showToast({ /* 配置对象 */ })` 方法来提示用户。此时，可以在

全局封装一个 `uni.$showMsg()` 方法，来简化 `uni.showToast()` 方法的调用。具体的改造步骤如下：

1. 在 `main.js` 中，为 `uni` 对象挂载自定义的 `$showMsg()` 方法：

```js
// 封装的展示消息提示的方法
uni.$showMsg = function (title = '数据加载失败！', duration = 1500) {
  uni.showToast({
    title,
    duration,
    icon: 'none',
  })
}
```

2. 今后，在需要提示消息的时候，直接调用 `uni.$showMsg()` 方法即可： 

```js
async getSwiperList() {
   const { data: res } = await uni.$http.get('/api/public/v1/home/swiperdata')
   if (res.meta.status !== 200) return uni.$showMsg()
   this.swiperList = res.message
}
```

#### 3、分类导航区域

##### 3.1 获取分类导航的数据

实现思路：

1. 定义 data 数据
2. 在 onLoad 中调用获取数据的方法
3. 在 methods 中定义获取数据的方法

示例代码如下：

```js
export default {
  data() {
    return {
      // 1. 分类导航的数据列表
      navList: [],
    }
  },
  onLoad() {
    // 2. 在 onLoad 中调用获取数据的方法
    this.getNavList()
  },
  methods: {
    // 3. 在 methods 中定义获取数据的方法
    async getNavList() {
      const { data: res } = await uni.$http.get('/api/public/v1/home/catitems')
      if (res.meta.status !== 200) return uni.$showMsg()
      this.navList = res.message
    },
  },
}
```

##### 3.2 渲染分类导航的 UI 结构

1. 定义如下的 UI 结构： 

```xml
<!-- 分类导航区域 -->
<view class="nav-list">
   <view class="nav-item" v-for="(item, i) in navList" :key="i">
     <image :src="item.image_src" class="nav-img"></image>
   </view>
</view>
```

2. 通过如下的样式美化页面结构：

```scss
.nav-list {
  display: flex;
  justify-content: space-around;
  margin: 15px 0;

  .nav-img {
    width: 128rpx;
    height: 140rpx;
  }
}
```

##### 3.2 点击第一项，切换到分类页面

1. 为 `nav-item` 绑定点击事件处理函数： 

```js
<!-- 分类导航区域 -->
<view class="nav-list">
  <view class="nav-item" v-for="(item, i) in navList" :key="i" @click="navClickHandler(item)">
    <image :src="item.image_src" class="nav-img"></image>
  </view>
</view>
```

2. 定义 `navClickHandler` 事件处理函数： 

```js
// nav-item 项被点击时候的事件处理函数
navClickHandler(item) {
  // 判断点击的是哪个 nav
  if (item.name === '分类') {
    uni.switchTab({
      url: '/pages/cate/cate'
    })
  }
}
```

#### 4、楼层区域

##### 4.1 获取楼层数据

实现思路：

1. 定义 data 数据
2. 在 onLoad 中调用获取数据的方法
3. 在 methods 中定义获取数据的方法

示例代码如下：

```js
export default {
  data() {
    return {
      // 1. 楼层的数据列表
      floorList: [],
    }
  },
  onLoad() {
    // 2. 在 onLoad 中调用获取楼层数据的方法
    this.getFloorList()
  },
  methods: {
    // 3. 定义获取楼层列表数据的方法
    async getFloorList() {
      const { data: res } = await uni.$http.get('/api/public/v1/home/floordata')
      if (res.meta.status !== 200) return uni.$showMsg()
      this.floorList = res.message
    },
  },
}
```

##### 4.2 渲染楼层的标题

1.  定义如下的 UI 结构： 

```xml
<!-- 楼层区域 -->
<view class="floor-list">
  <!-- 楼层 item 项 -->
  <view class="floor-item" v-for="(item, i) in floorList" :key="i">
    <!-- 楼层标题 -->
    <image :src="item.floor_title.image_src" class="floor-title"></image>
  </view>
</view>
```

2. 美化楼层标题的样式： 

```scss
.floor-title {
  height: 60rpx;
  width: 100%;
  display: flex;
}
```

##### 4.3 渲染楼层里的图片

1.  定义楼层图片区域的 UI 结构： 

```xml
<!-- 楼层图片区域 -->
<view class="floor-img-box">
  <!-- 左侧大图片的盒子 -->
  <view class="left-img-box">
    <image :src="item.product_list[0].image_src" :style="{width: item.product_list[0].image_width + 'rpx'}" mode="widthFix"></image>
  </view>
  <!-- 右侧 4 个小图片的盒子 -->
  <view class="right-img-box">
    <view class="right-img-item" v-for="(item2, i2) in item.product_list" :key="i2" v-if="i2 !== 0">
      <image :src="item2.image_src" mode="widthFix" :style="{width: item2.image_width + 'rpx'}"></image>
    </view>
  </view>
</view>
```

2. 美化楼层图片区域的样式： 

```scss
.right-img-box {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-around;
}

.floor-img-box {
  display: flex;
  padding-left: 10rpx;
}
```

##### 4.4 点击楼层图片跳转到商品列表页

1. 在 subpkg 分包中，新建 goods_list 页面

 ![img](https://www.escook.cn/docs-uni-shop/assets/img/2-3.de0b01ae.png) 

2.  楼层数据请求成功之后，通过双层 `forEach` 循环，处理 URL 地址： 

```js
// 获取楼层列表数据
async getFloorList() {
  const { data: res } = await uni.$http.get('/api/public/v1/home/floordata')
  if (res.meta.status !== 200) return uni.$showMsg()

  // 通过双层 forEach 循环，处理 URL 地址
  res.message.forEach(floor => {
    floor.product_list.forEach(prod => {
      prod.url = '/subpkg/goods_list/goods_list?' + prod.navigator_url.split('?')[1]
    })
  })

  this.floorList = res.message
}
```

3.  把图片外层的 `view` 组件，改造为 `navigator` 组件，并动态绑定 `url 属性` 的值： 

```xml
<!-- 楼层图片区域 -->
<view class="floor-img-box">
  <!-- 左侧大图片的盒子 -->
  <navigator class="left-img-box" :url="item.product_list[0].url">
    <image :src="item.product_list[0].image_src" :style="{width: item.product_list[0].image_width + 'rpx'}" mode="widthFix"></image>
  </navigator>
  <!-- 右侧 4 个小图片的盒子 -->
  <view class="right-img-box">
    <navigator class="right-img-item" v-for="(item2, i2) in item.product_list" :key="i2" v-if="i2 !== 0" :url="item2.url">
      <image :src="item2.image_src" mode="widthFix" :style="{width: item2.image_width + 'rpx'}"></image>
    </navigator>
  </view>
</view>
```

##### 4.5 分支的合并与提交

1.  将本地的 home 分支进行本地的 commit 提交： 

   ```bash
   git add .
   git commit -m "完成了 home 首页的开发"
   ```

2.  将本地的 home 分支推送到远程仓库进行保存： 

   ```bash
   git push -u origin home
   ```

3.  将本地的 home 分支合并到本地的 master 分支： 

   ```bash
   git checkout master
   git merge home
   ```

4.  删除本地的 home 分支： 

   ```bash
   git branch -d home
   ```

# 4、分类

#### 1、创建 cate 分支

 运行如下的命令，基于 master 分支在本地创建 cate 子分支，用来开发分类页面相关的功能： 

```bash
git checkout -b cate
```

#### 2、渲染分类页面的基本结构

1.  定义页面结构如下： 

```xml
<template>
  <view>
    <view class="scroll-view-container">
      <!-- 左侧的滚动视图区域 -->
      <scroll-view class="left-scroll-view" scroll-y :style="{height: wh + 'px'}">
        <view class="left-scroll-view-item active">xxx</view>
        <view class="left-scroll-view-item">xxx</view>
        <view class="left-scroll-view-item">xxx</view>
        <view class="left-scroll-view-item">xxx</view>
        <view class="left-scroll-view-item">xxx</view>
        <view class="left-scroll-view-item">多复制一些节点，演示纵向滚动效果...</view>
      </scroll-view>
      <!-- 右侧的滚动视图区域 -->
      <scroll-view class="right-scroll-view" scroll-y :style="{height: wh + 'px'}">
        <view class="left-scroll-view-item">zzz</view>
        <view class="left-scroll-view-item">zzz</view>
        <view class="left-scroll-view-item">zzz</view>
        <view class="left-scroll-view-item">zzz</view>
        <view class="left-scroll-view-item">多复制一些节点，演示纵向滚动效果</view>
      </scroll-view>
    </view>
  </view>
</template>
```

2.  动态计算窗口的剩余高度： 

   ```js
   <script>
     export default {
       data() {
         return {
           // 窗口的可用高度 = 屏幕高度 - navigationBar高度 - tabBar 高度
           wh: 0
         };
       },
       onLoad() {
         // 获取当前系统的信息
         const sysInfo = uni.getSystemInfoSync()
         // 为 wh 窗口可用高度动态赋值
         this.wh = sysInfo.windowHeight
       }
     }
   </script>
   ```

3. 美化页面结构

   ```scss
   .scroll-view-container {
     display: flex;
   
     .left-scroll-view {
       width: 120px;
   
       .left-scroll-view-item {
         line-height: 60px;
         background-color: #f7f7f7;
         text-align: center;
         font-size: 12px;
   
         // 激活项的样式
         &.active {
           background-color: #ffffff;
           position: relative;
   
           // 渲染激活项左侧的红色指示边线
           &::before {
             content: ' ';
             display: block;
             width: 3px;
             height: 30px;
             background-color: #c00000;
             position: absolute;
             left: 0;
             top: 50%;
             transform: translateY(-50%);
           }
         }
       }
     }
   }
   ```

#### 3、获取分类数据

1. 在data中定义分类数据节点

   ```js
   data() {
     return {
       // 分类数据列表
       cateList: []
     }
   }
   ```

2.  调用获取分类列表数据的方法： 

   ```js
   onLoad() {
     // 调用获取分类列表数据的方法
     this.getCateList()
   }
   ```

3.  定义获取分类列表数据的方法： 

   ```js
   methods: {
     async getCateList() {
       // 发起请求
       const { data: res } = await uni.$http.get('/api/public/v1/categories')
       // 判断是否获取失败
       if (res.meta.status !== 200) return uni.$showMsg()
       // 转存数据
       this.cateList = res.message
     }
   }
   ```

#### 4、动态渲染左侧的一级分类列表

1. 循环渲染列表结构： 

   ```xml
   <!-- 左侧的滚动视图区域 -->
   <scroll-view class="left-scroll-view" scroll-y :style="{height: wh + 'px'}">
     <block v-for="(item, i) in cateList" :key="i">
       <view class="left-scroll-view-item">{{item.cat_name}}</view>
     </block>
   </scroll-view>
   ```

2.  在 data 中定义默认选中项的索引： 

   ```js
   data() {
     return {
       // 当前选中项的索引，默认让第一项被选中
       active: 0
     }
   }
   ```

3.  循环渲染结构时，为选中项动态添加 `.active` 类名： 

   ```xml
   <block v-for="(item, i) in cateList" :key="i">
     <view :class="['left-scroll-view-item', i === active ? 'active' : '']">{{item.cat_name}}</view>
   </block>
   ```

4.  为一级分类的 Item 项绑定点击事件处理函数 `activeChanged`： 

   ```xml
   <block v-for="(item, i) in cateList" :key="i">
     <view :class="['left-scroll-view-item', i === active ? 'active' : '']" @click="activeChanged(i)">{{item.cat_name}}</view>
   </block>
   ```

5.  定义 `activeChanged` 事件处理函数，动态修改选中项的索引： 

   ```js
   methods: {
     // 选中项改变的事件处理函数
     activeChanged(i) {
       this.active = i
     }
   }
   ```

#### 5、动态渲染右侧的二级分类列表

1.  在 `data` 中定义二级分类列表的数据节点 

   ```js
   data() {
     return {
       // 二级分类列表
       cateLevel2: []
     }
   }
   ```

2.  修改 `getCateList` 方法，在请求到数据之后，为二级分类列表数据赋值： 

   ```js
   async getCateList() {
     const { data: res } = await uni.$http.get('/api/public/v1/categories')
     if (res.meta.status !== 200) return uni.$showMsg()
     this.cateList = res.message
     // 为二级分类赋值
     this.cateLevel2 = res.message[0].children
   }
   ```

3.  修改 `activeChanged` 方法，在一级分类选中项改变之后，为二级分类列表数据重新赋值： 

   ```js
   activeChanged(i) {
     this.active = i
     // 为二级分类列表重新赋值
     this.cateLevel2 = this.cateList[i].children
   }
   ```

4.  循环渲染右侧二级分类列表的 UI 结构： 

   ```xml
   <!-- 右侧的滚动视图区域 -->
   <scroll-view class="right-scroll-view" scroll-y :style="{height: wh + 'px'}">
     <view class="cate-lv2" v-for="(item2, i2) in cateLevel2" :key="i2">
       <view class="cate-lv2-title">/ {{item2.cat_name}} /</view>
     </view>
   </scroll-view>
   ```

5.  美化二级分类的标题样式： 

   ```scss
   .cate-lv2-title {
     font-size: 12px;
     font-weight: bold;
     text-align: center;
     padding: 15px 0;
   }
   ```

#### 6、动态渲染右侧的三级分类列表

1.  在二级分类的 `` 组件中，循环渲染三级分类的列表结构： 

   ```xml
   <!-- 右侧的滚动视图区域 -->
   <scroll-view class="right-scroll-view" scroll-y :style="{height: wh + 'px'}">
     <view class="cate-lv2" v-for="(item2, i2) in cateLevel2" :key="i2">
       <view class="cate-lv2-title">/ {{item2.cat_name}} /</view>
       <!-- 动态渲染三级分类的列表数据 -->
       <view class="cate-lv3-list">
         <!-- 三级分类 Item 项 -->
         <view class="cate-lv3-item" v-for="(item3, i3) in item2.children" :key="i3">
           <!-- 图片 -->
           <image :src="item3.cat_icon"></image>
           <!-- 文本 -->
           <text>{{item3.cat_name}}</text>
         </view>
       </view>
     </view>
   </scroll-view>
   ```

2.  美化三级分类的样式： 

   ```scss
   cate-lv3-list {
     display: flex;
     flex-wrap: wrap;
   
     .cate-lv3-item {
       width: 33.33%;
       margin-bottom: 10px;
       display: flex;
       flex-direction: column;
       align-items: center;
   
       image {
         width: 60px;
         height: 60px;
       }
   
       text {
         font-size: 12px;
       }
     }
   }
   ```

#### 7、切换一级分类后重置滚动条的位置

1.  在 data 中定义 `滚动条距离顶部的距离`： 

   ```js
   data() {
     return {
       // 滚动条距离顶部的距离
       scrollTop: 0
     }
   }
   ```

2.  动态为右侧的<scroll-view>组件绑定 `scroll-top` 属性的值： 

   ```xml
   <!-- 右侧的滚动视图区域 -->
   <scroll-view class="right-scroll-view" scroll-y :style="{height: wh + 'px'}" :scroll-top="scrollTop"></scroll-view>
   ```

3.  切换一级分类时，动态设置 `scrollTop` 的值： 

   ```js
   // 选中项改变的事件处理函数
   activeChanged(i) {
     this.active = i
     this.cateLevel2 = this.cateList[i].children
   
     // 让 scrollTop 的值在 0 与 1 之间切换
     this.scrollTop = this.scrollTop === 0 ? 1 : 0
   
     // 可以简化为如下的代码：
     // this.scrollTop = this.scrollTop ? 0 : 1
   }
   ```

#### 8、点击三级分类跳转到商品列表页面

1.  为三级分类的 Item 项绑定点击事件处理函数如下： 

   ```xml
   <view class="cate-lv3-item" v-for="(item3, i3) in item2.children" :key="i3" @click="gotoGoodsList(item3)">
     <image :src="item3.cat_icon"></image>
     <text>{{item3.cat_name}}</text>
   </view>
   ```

2.  定义事件处理函数如下： 

   ```js
   // 点击三级分类项跳转到商品列表页面
   gotoGoodsList(item3) {
     uni.navigateTo({
       url: '/subpkg/goods_list/goods_list?cid=' + item3.cat_id
     })
   }
   ```

#### 9、分支的合并与提交

1. 将 `cate` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了分类页面的开发"
   ```

2. 将本地的 `cate` 分支推送到码云：

   ```bash
   git push -u origin cate
   ```

3. 将本地 `cate` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge cate
   git push
   ```

4. 删除本地的 `cate` 分支：

   ```bash
   git branch -d cate
   ```

# 5、搜索

#### 1、创建 search 分支

运行如下的命令，基于 master 分支在本地创建 search 子分支，用来开发搜索相关的功能：

```bash
git checkout -b search
```

#### 2、自定义搜索组件

##### 2.1 自定义 my-search 组件

1. 在项目根目录的 `components` 目录上，鼠标右键，选择 `新建组件`，填写组件信息后，最后点击 `创建` 按钮：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/5-1.25ab714d.png)

2. 在分类页面的 UI 结构中，直接以标签的形式使用 `my-search` 自定义组件：

   ```xml
   <!-- 使用自定义的搜索组件 -->
   <my-search></my-search>
   ```

3. 定义 `my-search` 组件的 UI 结构如下：

   ```xml
   <template>
     <view class="my-search-container">
       <!-- 使用 view 组件模拟 input 输入框的样式 -->
       <view class="my-search-box">
         <uni-icons type="search" size="17"></uni-icons>
         <text class="placeholder">搜索</text>
       </view>
     </view>
   </template>
   ```

   > 注意：在当前组件中，我们使用 view 组件模拟 input 输入框的效果；并不会在页面上渲染真正的 input 输入框

4. 美化自定义 search 组件的样式：

   ```scss
   .my-search-container {
     background-color: #c00000;
     height: 50px;
     padding: 0 10px;
     display: flex;
     align-items: center;
   }
   
   .my-search-box {
     height: 36px;
     background-color: #ffffff;
     border-radius: 15px;
     width: 100%;
     display: flex;
     align-items: center;
     justify-content: center;
   
     .placeholder {
       font-size: 15px;
       margin-left: 5px;
     }
   }
   ```

5. 由于自定义的 `my-search` 组件高度为 `50px`，因此，需要重新计算分类页面窗口的可用高度：

   ```js
   onLoad() {
     const sysInfo = uni.getSystemInfoSync()
     // 可用高度 = 屏幕高度 - navigationBar高度 - tabBar高度 - 自定义的search组件高度
     this.wh = sysInfo.windowHeight - 50
   }
   ```

##### 2.2 通过自定义属性增强组件的通用性

为了增强组件的通用性，我们允许使用者自定义搜索组件的 `背景颜色` 和 `圆角尺寸`。

1. 通过 `props` 定义 `bgcolor` 和 `radius` 两个属性，并指定值类型和属性默认值：

   ```js
   props: {
     // 背景颜色
     bgcolor: {
       type: String,
       default: '#C00000'
     },
     // 圆角尺寸
     radius: {
       type: Number,
       // 单位是 px
       default: 18
     }
   }
   ```

2. 通过属性绑定的形式，为 `.my-search-container` 盒子和 `.my-search-box` 盒子动态绑定 `style` 属性：

   ```xml
   <view class="my-search-container" :style="{'background-color': bgcolor}">
     <view class="my-search-box" :style="{'border-radius': radius + 'px'}">
       <uni-icons type="search" size="17"></uni-icons>
       <text class="placeholder">搜索</text>
     </view>
   </view>
   ```

3. 移除对应 `scss` 样式中的 `背景颜色` 和 `圆角尺寸`：

   ```scss
   .my-search-container {
     // 移除背景颜色，改由 props 属性控制
     // background-color: #C00000;
     height: 50px;
     padding: 0 10px;
     display: flex;
     align-items: center;
   }
   
   .my-search-box {
     height: 36px;
     background-color: #ffffff;
     // 移除圆角尺寸，改由 props 属性控制
     // border-radius: 15px;
     width: 100%;
     display: flex;
     align-items: center;
     justify-content: center;
   
     .placeholder {
       font-size: 15px;
       margin-left: 5px;
     }
   }
   ```

##### 2.3 为自定义组件封装 click 事件

1. 在 `my-search` 自定义组件内部，给类名为 `.my-search-box` 的 `view` 绑定 `click` 事件处理函数：

   ```xml
   <view class="my-search-box" :style="{'border-radius': radius + 'px'}" @click="searchBoxHandler">
     <uni-icons type="search" size="17"></uni-icons>
     <text class="placeholder">搜索</text>
   </view>
   ```

2. 在 `my-search` 自定义组件的 `methods` 节点中，声明事件处理函数如下：

   ```js
   methods: {
     // 点击了模拟的 input 输入框
     searchBoxHandler() {
       // 触发外界通过 @click 绑定的 click 事件处理函数
       this.$emit('click')
     }
   }
   ```

3. 在分类页面中使用 `my-search` 自定义组件时，即可通过 `@click` 为其绑定点击事件处理函数：

   ```xml
   <!-- 使用自定义的搜索组件 -->
   <my-search @click="gotoSearch"></my-search>
   ```

   同时在分类页面中，定义 `gotoSearch` 事件处理函数如下：

   ```js
   methods: {
      // 跳转到分包中的搜索页面
      gotoSearch() {
        uni.navigateTo({
          url: '/subpkg/search/search'
        })
      }
   }
   ```

##### 2.4 实现首页搜索组件的吸顶效果

1. 在 home 首页定义如下的 UI 结构：

   ```xml
   <!-- 使用自定义的搜索组件 -->
   <view class="search-box">
     <my-search @click="gotoSearch"></my-search>
   </view>
   ```

2. 在 home 首页定义如下的事件处理函数：

   ```js
   gotoSearch() {
     uni.navigateTo({
       url: '/subpkg/search/search'
     })
   }
   ```

3. 通过如下的样式实现吸顶的效果：

   ```scss
   .search-box {
     // 设置定位效果为“吸顶”
     position: sticky;
     // 吸顶的“位置”
     top: 0;
     // 提高层级，防止被轮播图覆盖
     z-index: 999;
   }
   ```

#### 3、搜索建议

##### 3.1 渲染搜索页面的基本结构

1. 定义如下的 UI 结构：

   ```xml
   <view class="search-box">
     <!-- 使用 uni-ui 提供的搜索组件 -->
     <uni-search-bar @input="input" :radius="100" cancelButton="none"></uni-search-bar>
   </view>
   ```

2. 修改 `components -> uni-search-bar -> uni-search-bar.vue` 组件，将默认的白色搜索背景改为 `#C00000` 的红色背景：

   ```css
   .uni-searchbar {
     /* #ifndef APP-NVUE */
     display: flex;
     /* #endif */
     flex-direction: row;
     position: relative;
     padding: 16rpx;
     /* 将默认的 #FFFFFF 改为 #C00000 */
     background-color: #c00000;
   }
   ```

3. 实现搜索框的吸顶效果：

   ```scss
   .search-box {
     position: sticky;
     top: 0;
     z-index: 999;
   }
   ```

4. 定义如下的 input 事件处理函数：

   ```js
   methods: {
     input(e) {
       // e.value 是最新的搜索内容
       console.log(e.value)
     }
   }
   ```

##### 3.2 实现搜索框自动获取焦点

1. 修改 `components -> uni-search-bar -> uni-search-bar.vue` 组件，把 data 数据中的 `show` 和 `showSync` 的值，从默认的 `false`改为 `true` 即可：

   ```js
   data() {
     return {
       show: true,
       showSync: true,
       searchVal: ""
     }
   }
   ```

2. 使用手机扫码预览，即可在真机上查看效果。

##### 3.3 实现搜索框的防抖处理

1. 在 data 中定义防抖的延时器 timerId 如下：

   ```js
   data() {
     return {
       // 延时器的 timerId
       timer: null,
       // 搜索关键词
       kw: ''
     }
   }
   ```

2. 修改 `input` 事件处理函数如下：

   ```js
   input(e) {
     // 清除 timer 对应的延时器
     clearTimeout(this.timer)
     // 重新启动一个延时器，并把 timerId 赋值给 this.timer
     this.timer = setTimeout(() => {
       // 如果 500 毫秒内，没有触发新的输入事件，则为搜索关键词赋值
       this.kw = e.value
       console.log(this.kw)
     }, 500)
   }
   ```

##### 3.4 根据关键词查询搜索建议列表

1. 在 data 中定义如下的数据节点，用来存放搜索建议的列表数据：

   ```js
   data() {
     return {
       // 搜索结果列表
       searchResults: []
     }
   }
   ```

2. 在防抖的 `setTimeout` 中，调用 `getSearchList` 方法获取搜索建议列表

   ```js
   this.timer = setTimeout(() => {
     this.kw = e.value
     // 根据关键词，查询搜索建议列表
     this.getSearchList()
   }, 500)
   ```

3. 在 `methods` 中定义 `getSearchList` 方法如下：

   ```js
   // 根据搜索关键词，搜索商品建议列表
   async getSearchList() {
     // 判断关键词是否为空
     if (this.kw === '') {
       this.searchResults = []
       return
     }
     // 发起请求，获取搜索建议列表
     const { data: res } = await uni.$http.get('/api/public/v1/goods/qsearch', { query: this.kw })
     if (res.meta.status !== 200) return uni.$showMsg()
     this.searchResults = res.message
   }
   ```

##### 3.5 渲染搜索建议列表

1. 定义如下的 UI 结构：

   ```xml
   <!-- 搜索建议列表 -->
   <view class="sugg-list">
     <view class="sugg-item" v-for="(item, i) in searchResults" :key="i" @click="gotoDetail(item.goods_id)">
       <view class="goods-name">{{item.goods_name}}</view>
       <uni-icons type="arrowright" size="16"></uni-icons>
     </view>
   </view>
   ```

2. 美化搜索建议列表：

   ```scss
   .sugg-list {
     padding: 0 5px;
   
     .sugg-item {
       font-size: 12px;
       padding: 13px 0;
       border-bottom: 1px solid #efefef;
       display: flex;
       align-items: center;
       justify-content: space-between;
   
       .goods-name {
         // 文字不允许换行（单行文本）
         white-space: nowrap;
         // 溢出部分隐藏
         overflow: hidden;
         // 文本溢出后，使用 ... 代替
         text-overflow: ellipsis;
         margin-right: 3px;
       }
     }
   }
   ```

3. 点击搜索建议的 Item 项，跳转到商品详情页面：

   ```js
   gotoDetail(goods_id) {
     uni.navigateTo({
       // 指定详情页面的 URL 地址，并传递 goods_id 参数
       url: '/subpkg/goods_detail/goods_detail?goods_id=' + goods_id
     })
   }
   ```

#### 4、搜索历史

##### 4.1 渲染搜索历史记录的基本结构

1. 在 data 中定义搜索历史的`假数据`：

   ```js
   data() {
     return {
       // 搜索关键词的历史记录
       historyList: ['a', 'app', 'apple']
     }
   }
   ```

2. 渲染搜索历史区域的 UI 结构：

   ```xml
   <!-- 搜索历史 -->
   <view class="history-box">
     <!-- 标题区域 -->
     <view class="history-title">
       <text>搜索历史</text>
       <uni-icons type="trash" size="17"></uni-icons>
     </view>
     <!-- 列表区域 -->
     <view class="history-list">
       <uni-tag :text="item" v-for="(item, i) in historyList" :key="i"></uni-tag>
     </view>
   </view>
   ```

3. 美化搜索历史区域的样式：

   ```scss
   .history-box {
     padding: 0 5px;
   
     .history-title {
       display: flex;
       justify-content: space-between;
       align-items: center;
       height: 40px;
       font-size: 13px;
       border-bottom: 1px solid #efefef;
     }
   
     .history-list {
       display: flex;
       flex-wrap: wrap;
   
       .uni-tag {
         margin-top: 5px;
         margin-right: 5px;
       }
     }
   }
   ```

##### 4.2 实现搜索建议和搜索历史的按需展示

1. 当搜索结果列表的长度`不为 0`的时候（`searchResults.length !== 0`），需要展示搜索建议区域，隐藏搜索历史区域

2. 当搜索结果列表的长度`等于 0`的时候（`searchResults.length === 0`），需要隐藏搜索建议区域，展示搜索历史区域

3. 使用 `v-if` 和 `v-else` 控制这两个区域的显示和隐藏，示例代码如下：

   ```xml
   <!-- 搜索建议列表 -->
   <view class="sugg-list" v-if="searchResults.length !== 0">
     <!-- 省略其它代码... -->
   </view>
   
   <!-- 搜索历史 -->
   <view class="history-box" v-else>
     <!-- 省略其它代码... -->
   </view>
   ```

##### 4.3 将搜索关键词存入 historyList

1. 直接将搜索关键词 `push` 到 `historyList` 数组中即可

   ```js
   methods: {
     // 根据搜索关键词，搜索商品建议列表
     async getSearchList() {
       // 省略其它不必要的代码...
   
       // 1. 查询到搜索建议之后，调用 saveSearchHistory() 方法保存搜索关键词
       this.saveSearchHistory()
     },
     // 2. 保存搜索关键词的方法
     saveSearchHistory() {
       // 2.1 直接把搜索关键词 push 到 historyList 数组中
       this.historyList.push(this.kw)
     }
   }
   ```

2. 上述实现思路存在的问题：

   - 关键词**前后顺序**的问题（可以调用数组的 `reverse() 方法`对数组进行反转）
   - 关键词**重复**的问题（可以使用 [Set 对象](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set)进行**去重操作**）

##### 4.4  解决关键字前后顺序的问题

1. data 中的 `historyList` 不做任何修改，依然使用 push 进行**末尾追加**

2. 定义一个计算属性 `historys`，将 `historyList` 数组 `reverse` 反转之后，就是此计算属性的值：

   ```js
   computed: {
     historys() {
       // 注意：由于数组是引用类型，所以不要直接基于原数组调用 reverse 方法，以免修改原数组中元素的顺序
       // 而是应该新建一个内存无关的数组，再进行 reverse 反转
       return [...this.historyList].reverse()
     }
   }
   ```

3. 页面中渲染搜索关键词的时候，不再使用 data 中的 `historyList`，而是使用计算属性 `historys`：

   ```xml
   <view class="history-list">
     <uni-tag :text="item" v-for="(item, i) in historys" :key="i"></uni-tag>
   </view>
   ```

##### 4.5 解决关键词重复的问题

修改 `saveSearchHistory` 方法如下：

```js
// 保存搜索关键词为历史记录
saveSearchHistory() {
  // this.historyList.push(this.kw)

  // 1. 将 Array 数组转化为 Set 对象
  const set = new Set(this.historyList)
  // 2. 调用 Set 对象的 delete 方法，移除对应的元素
  set.delete(this.kw)
  // 3. 调用 Set 对象的 add 方法，向 Set 中添加元素
  set.add(this.kw)
  // 4. 将 Set 对象转化为 Array 数组
  this.historyList = Array.from(set)
}
```

##### 4.6 将搜索历史记录持久化存储到本地

1. 修改 `saveSearchHistory` 方法如下：

   ```js
   // 保存搜索关键词为历史记录
   saveSearchHistory() {
     const set = new Set(this.historyList)
     set.delete(this.kw)
     set.add(this.kw)
     this.historyList = Array.from(set)
     // 调用 uni.setStorageSync(key, value) 将搜索历史记录持久化存储到本地
     uni.setStorageSync('kw', JSON.stringify(this.historyList))
   }
   ```

2. 在 `onLoad` 生命周期函数中，加载本地存储的搜索历史记录：

   ```js
   onLoad() {
     this.historyList = JSON.parse(uni.getStorageSync('kw') || '[]')
   }
   ```

##### 4.7 清空搜索历史记录

1. 为清空的图标按钮绑定 `click` 事件：

   ```xml
   <uni-icons type="trash" size="17" @click="cleanHistory"></uni-icons>
   ```

2. 在 `methods` 中定义 `cleanHistory` 处理函数：

   ```js
   // 清空搜索历史记录
   cleanHistory() {
     // 清空 data 中保存的搜索历史
     this.historyList = []
     // 清空本地存储中记录的搜索历史
     uni.setStorageSync('kw', '[]')
   }
   ```

##### 4.8 点击搜索历史跳转到商品列表页面

1. 为搜索历史的 Item 项绑定 `click` 事件处理函数：

   ```xml
   <uni-tag :text="item" v-for="(item, i) in historys" :key="i" @click="gotoGoodsList(item)"></uni-tag>
   ```

2. 在 `methods` 中定义 `gotoGoodsList` 处理函数：

   ```js
   // 点击跳转到商品列表页面
   gotoGoodsList(kw) {
     uni.navigateTo({
       url: '/subpkg/goods_list/goods_list?query=' + kw
     })
   }
   ```

#### 5、分支的合并与提交

1. 将 `search` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了搜索功能的开发"
   ```

2. 将本地的 `search` 分支推送到码云：

   ```bash
   git push -u origin search
   ```

3. 将本地 `search` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge search
   git push
   ```

4. 删除本地的 `search` 分支：

   ```bash
   git branch -d search
   ```

# 商品列表

 运行如下的命令，基于 master 分支在本地创建 goodslist 子分支，用来开发商品列表相关的功能： 

```bash
git checkout -b goodslist
```

#### 1、定义请求参数对象

1. 为了方便发起请求获取商品列表的数据，我们要根据接口的要求，事先定义一个**请求参数对象**：

   ```js
   data() {
     return {
       // 请求参数对象
       queryObj: {
         // 查询关键词
         query: '',
         // 商品分类Id
         cid: '',
         // 页码值
         pagenum: 1,
         // 每页显示多少条数据
         pagesize: 10
       }
     }
   }
   ```

2. 将页面跳转时**携带的参数**，转存到 `queryObj` 对象中：

   ```js
   onLoad(options) {
     // 将页面参数转存到 this.queryObj 对象中
     this.queryObj.query = options.query || ''
     this.queryObj.cid = options.cid || ''
   }
   ```

3. 为了方便开发商品分类页面，建议大家通过**微信开发者工具**，新建商品列表页面的**编译模式**：

   ​	 ![img](data:image/png;base64,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) 

#### 2、获取商品列表数据

1. 在 data 中新增如下的数据节点：

   ```js
   data() {
     return {
       // 商品列表的数据
       goodsList: [],
       // 总数量，用来实现分页
       total: 0
     }
   }
   ```

2. 在 `onLoad` 生命周期函数中，调用 `getGoodsList` 方法获取商品列表数据：

   ```js
   onLoad(options) {
     // 调用获取商品列表数据的方法
     this.getGoodsList()
   }
   ```

3. 在 `methods` 节点中，声明 `getGoodsList` 方法如下：

   ```js
   methods: {
     // 获取商品列表数据的方法
     async getGoodsList() {
       // 发起请求
       const { data: res } = await uni.$http.get('/api/public/v1/goods/search', this.queryObj)
       if (res.meta.status !== 200) return uni.$showMsg()
       // 为数据赋值
       this.goodsList = res.message.goods
       this.total = res.message.total
     }
   }
   ```

#### 3、渲染商品列表结构

1. 在页面中，通过 `v-for` 指令，循环渲染出商品的 UI 结构：

   ```xml
   <template>
     <view>
       <view class="goods-list">
         <block v-for="(goods, i) in goodsList" :key="i">
           <view class="goods-item">
             <!-- 商品左侧图片区域 -->
             <view class="goods-item-left">
               <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
             </view>
             <!-- 商品右侧信息区域 -->
             <view class="goods-item-right">
               <!-- 商品标题 -->
               <view class="goods-name">{{goods.goods_name}}</view>
               <view class="goods-info-box">
                 <!-- 商品价格 -->
                 <view class="goods-price">￥{{goods.goods_price}}</view>
               </view>
             </view>
           </view>
         </block>
       </view>
     </view>
   </template>
   ```

2. 为了防止某些商品的图片不存在，需要在 data 中定义一个默认的图片：

   ```js
   data() {
     return {
       // 默认的空图片
       defaultPic: 'https://img3.doubanio.com/f/movie/8dd0c794499fe925ae2ae89ee30cd225750457b4/pics/movie/celebrity-default-medium.png'
     }
   }
   ```

   并在页面渲染时按需使用：

   ```xml
   <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
   ```

3. 美化商品列表的 UI 结构：

   ```scss
   .goods-item {
     display: flex;
     padding: 10px 5px;
     border-bottom: 1px solid #f0f0f0;
   
     .goods-item-left {
       margin-right: 5px;
   
       .goods-pic {
         width: 100px;
         height: 100px;
         display: block;
       }
     }
   
     .goods-item-right {
       display: flex;
       flex-direction: column;
       justify-content: space-between;
   
       .goods-name {
         font-size: 13px;
       }
   
       .goods-price {
         font-size: 16px;
         color: #c00000;
       }
     }
   }
   ```

#### 4、把商品 item 项封装为自定义组件

1. 在 `components` 目录上鼠标右键，选择 `新建组件`：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/6-2.6a66124f.png)

2. 将 `goods_list` 页面中，关于商品 item 项相关的 UI 结构、样式、data 数据，封装到 `my-goods` 组件中：

   ```html
   <template>
     <view class="goods-item">
       <!-- 商品左侧图片区域 -->
       <view class="goods-item-left">
         <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
       </view>
       <!-- 商品右侧信息区域 -->
       <view class="goods-item-right">
         <!-- 商品标题 -->
         <view class="goods-name">{{goods.goods_name}}</view>
         <view class="goods-info-box">
           <!-- 商品价格 -->
           <view class="goods-price">￥{{goods.goods_price}}</view>
         </view>
       </view>
     </view>
   </template>
   
   <script>
     export default {
       // 定义 props 属性，用来接收外界传递到当前组件的数据
       props: {
         // 商品的信息对象
         goods: {
           type: Object,
           defaul: {},
         },
       },
       data() {
         return {
           // 默认的空图片
           defaultPic: 'https://img3.doubanio.com/f/movie/8dd0c794499fe925ae2ae89ee30cd225750457b4/pics/movie/celebrity-default-medium.png',
         }
       },
     }
   </script>
   
   <style lang="scss">
     .goods-item {
       display: flex;
       padding: 10px 5px;
       border-bottom: 1px solid #f0f0f0;
   
       .goods-item-left {
         margin-right: 5px;
   
         .goods-pic {
           width: 100px;
           height: 100px;
           display: block;
         }
       }
   
       .goods-item-right {
         display: flex;
         flex-direction: column;
         justify-content: space-between;
   
         .goods-name {
           font-size: 13px;
         }
   
         .goods-price {
           font-size: 16px;
           color: #c00000;
         }
       }
     }
   </style>
   ```

3. 在 `goods_list` 组件中，循环渲染 `my-goods` 组件即可：

   ```xml
   <view class="goods-list">
     <block v-for="(item, i) in goodsList" :key="i">
       <!-- 为 my-goods 组件动态绑定 goods 属性的值 -->
       <my-goods :goods="item"></my-goods>
     </block>
   </view>
   ```

#### 5、使用过滤器处理价格

1. 在 `my-goods` 组件中，和 `data` 节点平级，声明 `filters` 过滤器节点如下：

   ```js
   filters: {
     // 把数字处理为带两位小数点的数字
     tofixed(num) {
       return Number(num).toFixed(2)
     }
   }
   ```

2. 在渲染商品价格的时候，通过管道符 `|` 调用过滤器：

   ```xml
   <!-- 商品价格 -->
   <view class="goods-price">￥{{goods.goods_price | tofixed}}</view>
   ```

#### 6、上拉加载更多

##### 6.1 初步实现上拉加载更多

1. 打开项目根目录中的 `pages.json` 配置文件，为 `subPackages` 分包中的 `goods_list` 页面配置上拉触底的距

   离：

   ```js
    "subPackages": [
      {
        "root": "subpkg",
        "pages": [
          {
            "path": "goods_detail/goods_detail",
            "style": {}
          },
          {
            "path": "goods_list/goods_list",
            "style": {
              "onReachBottomDistance": 150
            }
          },
          {
            "path": "search/search",
            "style": {}
          }
        ]
      }
    ]
   ```

2. 在 `goods_list` 页面中，和 `methods` 节点平级，声明 `onReachBottom` 事件处理函数，用来监听页面的上拉触底行为：

   ```js
   // 触底的事件
   onReachBottom() {
     // 让页码值自增 +1
     this.queryObj.pagenum += 1
     // 重新获取列表数据
     this.getGoodsList()
   }
   ```

3. 改造 `methods` 中的 `getGoodsList` 函数，当列表数据请求成功之后，进行新旧数据的拼接处理：

   ```js
   // 获取商品列表数据的方法
   async getGoodsList() {
     // 发起请求
     const { data: res } = await uni.$http.get('/api/public/v1/goods/search', this.queryObj)
     if (res.meta.status !== 200) return uni.$showMsg()
   
     // 为数据赋值：通过展开运算符的形式，进行新旧数据的拼接
     this.goodsList = [...this.goodsList, ...res.message.goods]
     this.total = res.message.total
   }
   ```

##### 6.2 通过节流阀防止发起额外的请求

1. 在 data 中定义 `isloading` 节流阀如下：

   ```js
   data() {
     return {
       // 是否正在请求数据
       isloading: false
     }
   }
   ```

2. 修改 `getGoodsList` 方法，在请求数据前后，分别打开和关闭节流阀：

   ```js
   // 获取商品列表数据的方法
   async getGoodsList() {
     // ** 打开节流阀
     this.isloading = true
     // 发起请求
     const { data: res } = await uni.$http.get('/api/public/v1/goods/search', this.queryObj)
     // ** 关闭节流阀
     this.isloading = false
   
     // 省略其它代码...
   }
   ```

3. 在 `onReachBottom` 触底事件处理函数中，根据节流阀的状态，来决定是否发起请求：

   ```js
   // 触底的事件
   onReachBottom() {
     // 判断是否正在请求其它数据，如果是，则不发起额外的请求
     if (this.isloading) return
   
     this.queryObj.pagenum += 1
     this.getGoodsList()
   }
   ```

##### 6.3 判断数据是否加载完毕

1. 如果下面的公式成立，则证明没有下一页数据了：

   ```text
   当前的页码值 * 每页显示多少条数据 >= 总数条数
   pagenum * pagesize >= total
   ```

2. 修改 `onReachBottom` 事件处理函数如下：

   ```js
   // 触底的事件
   onReachBottom() {
     // 判断是否还有下一页数据
     if (this.queryObj.pagenum * this.queryObj.pagesize >= this.total) return uni.$showMsg('数据加载完毕！')
   
     // 判断是否正在请求其它数据，如果是，则不发起额外的请求
     if (this.isloading) return
   
     this.queryObj.pagenum += 1
     this.getGoodsList()
   }
   ```

#### 7、下拉刷新

1. 在 `pages.json` 配置文件中，为当前的 `goods_list` 页面单独开启下拉刷新效果：

   ```js
   "subPackages": [{
     "root": "subpkg",
     "pages": [{
       "path": "goods_detail/goods_detail",
       "style": {}
     }, {
       "path": "goods_list/goods_list",
       "style": {
         "onReachBottomDistance": 150,
         "enablePullDownRefresh": true,
         "backgroundColor": "#F8F8F8"
       }
     }, {
       "path": "search/search",
       "style": {}
     }]
   }]
   ```

2. 监听页面的 `onPullDownRefresh` 事件处理函数：

   ```js
   // 下拉刷新的事件
   onPullDownRefresh() {
     // 1. 重置关键数据
     this.queryObj.pagenum = 1
     this.total = 0
     this.isloading = false
     this.goodsList = []
   
     // 2. 重新发起请求
     this.getGoodsList(() => uni.stopPullDownRefresh())
   }
   ```

3. 修改 `getGoodsList` 函数，接收 `cb` 回调函数并按需进行调用：

   ```js
   // 获取商品列表数据的方法
   async getGoodsList(cb) {
     this.isloading = true
     const { data: res } = await uni.$http.get('/api/public/v1/goods/search', this.queryObj)
     this.isloading = false
     // 只要数据请求完毕，就立即按需调用 cb 回调函数
     cb && cb()
   
     if (res.meta.status !== 200) return uni.$showMsg()
     this.goodsList = [...this.goodsList, ...res.message.goods]
     this.total = res.message.total
   }
   ```

#### 8、点击商品 item 项跳转到详情页面

1. 将循环时的 `block` 组件修改为 `view` 组件，并绑定 `click` 点击事件处理函数：

   ```xml
   <view class="goods-list">
     <view v-for="(item, i) in goodsList" :key="i" @click="gotoDetail(item)">
       <!-- 为 my-goods 组件动态绑定 goods 属性的值 -->
       <my-goods :goods="item"></my-goods>
     </view>
   </view>
   ```

2. 在 `methods` 节点中，定义 `gotoDetail` 事件处理函数：

   ```js
   // 点击跳转到商品详情页面
   gotoDetail(item) {
     uni.navigateTo({
       url: '/subpkg/goods_detail/goods_detail?goods_id=' + item.goods_id
     })
   }
   ```

#### 9、分支的合并与提交

1. 将 `goodslist` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了商品列表页面的开发"
   ```

2. 将本地的 `goodslist` 分支推送到码云：

   ```bash
   git push -u origin goodslist
   ```

3. 将本地 `goodslist` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge goodslist
   git push
   ```

4. 删除本地的 `goodslist` 分支：

   ```bash
   git branch -d goodslist
   ```

# 商品详情

#### 1、创建 goodsdetail 分支

运行如下的命令，基于 master 分支在本地创建 goodsdetail 子分支，用来开发商品详情页相关的功能：

```bash
git checkout -b goodsdetail
```

#### 2、添加商品详情页的编译模式

1. 在微信开发者工具中，点击工具栏上的编译模式下拉菜单，选择 `添加编译模式` 选项：

   ![img](data:image/png;base64,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)

2. 勾选 `启动页面` 的路径，并填写了 `启动参数` 之后，点击 `确定` 按钮，添加详情页面的编译模式：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/7-2.82dd8e0f.png)

#### 3、获取商品详情数据

1. 在 `data` 中定义商品详情的数据节点：

   ```js
   data() {
     return {
       // 商品详情对象
       goods_info: {}
     }
   }
   ```

2. 在 `onLoad` 中获取商品的 Id，并调用请求商品详情的方法：

   ```js
   onLoad(options) {
     // 获取商品 Id
     const goods_id = options.goods_id
     // 调用请求商品详情数据的方法
     this.getGoodsDetail(goods_id)
   }
   ```

3. 在 `methods` 中声明 `getGoodsDetail` 方法：

   ```js
   methods: {
     // 定义请求商品详情数据的方法
     async getGoodsDetail(goods_id) {
       const { data: res } = await uni.$http.get('/api/public/v1/goods/detail', { goods_id })
       if (res.meta.status !== 200) return uni.$showMsg()
       // 为 data 中的数据赋值
       this.goods_info = res.message
     }
   }
   ```

#### 4、渲染商品详情页的 UI 结构

##### 4.1 渲染轮播图区域

1. 使用 `v-for` 指令，循环渲染如下的轮播图 UI 结构：

   ```xml
   <!-- 轮播图区域 -->
   <swiper :indicator-dots="true" :autoplay="true" :interval="3000" :duration="1000" :circular="true">
     <swiper-item v-for="(item, i) in goods_info.pics" :key="i">
       <image :src="item.pics_big"></image>
     </swiper-item>
   </swiper>
   ```

2. 美化轮播图的样式：

   ```scss
   swiper {
     height: 750rpx;
   
     image {
       width: 100%;
       height: 100%;
     }
   }
   ```

#####   4.2 实现轮播图预览效果

1. 为轮播图中的 `image` 图片绑定 `click` 事件处理函数：

   ```xml
   <swiper-item v-for="(item, i) in goods_info.pics" :key="i">
     <!-- 把当前点击的图片的索引，传递到 preview() 处理函数中 -->
     <image :src="item.pics_big" @click="preview(i)"></image>
   </swiper-item>
   ```

2. 在 `methods` 中定义 `preview` 事件处理函数：

   ```js
   // 实现轮播图的预览效果
   preview(i) {
     // 调用 uni.previewImage() 方法预览图片
     uni.previewImage({
       // 预览时，默认显示图片的索引
       current: i,
       // 所有图片 url 地址的数组
       urls: this.goods_info.pics.map(x => x.pics_big)
     })
   }
   ```

##### 4.3 渲染商品信息区域

1. 定义商品信息区域的 UI 结构如下：

   ```xml
   <!-- 商品信息区域 -->
   <view class="goods-info-box">
     <!-- 商品价格 -->
     <view class="price">￥{{goods_info.goods_price}}</view>
     <!-- 信息主体区域 -->
     <view class="goods-info-body">
       <!-- 商品名称 -->
       <view class="goods-name">{{goods_info.goods_name}}</view>
       <!-- 收藏 -->
       <view class="favi">
         <uni-icons type="star" size="18" color="gray"></uni-icons>
         <text>收藏</text>
       </view>
     </view>
     <!-- 运费 -->
     <view class="yf">快递：免运费</view>
   </view>
   ```

2. 美化商品信息区域的样式：

   ```scss
   // 商品信息区域的样式
   .goods-info-box {
     padding: 10px;
     padding-right: 0;
   
     .price {
       color: #c00000;
       font-size: 18px;
       margin: 10px 0;
     }
   
     .goods-info-body {
       display: flex;
       justify-content: space-between;
   
       .goods-name {
         font-size: 13px;
         padding-right: 10px;
       }
       // 收藏区域
       .favi {
         width: 120px;
         font-size: 12px;
         display: flex;
         flex-direction: column;
         justify-content: center;
         align-items: center;
         border-left: 1px solid #efefef;
         color: gray;
       }
     }
   
     // 运费
     .yf {
       margin: 10px 0;
       font-size: 12px;
       color: gray;
     }
   }
   ```

##### 4.4 渲染商品详情信息

1. 在页面结构中，使用 `rich-text` 组件，将带有 HTML 标签的内容，渲染为小程序的页面结构：

   ```xml
   <!-- 商品详情信息 -->
   <rich-text :nodes="goods_info.goods_introduce"></rich-text>
   ```

2. 修改 `getGoodsDetail` 方法，从而解决图片底部 `空白间隙` 的问题：

   ```js
   // 定义请求商品详情数据的方法
   async getGoodsDetail(goods_id) {
     const { data: res } = await uni.$http.get('/api/public/v1/goods/detail', { goods_id })
     if (res.meta.status !== 200) return uni.$showMsg()
   
     // 使用字符串的 replace() 方法，为 img 标签添加行内的 style 样式，从而解决图片底部空白间隙的问题
     res.message.goods_introduce = res.message.goods_introduce.replace(/<img /g, '<img style="display:block;" ')
     this.goods_info = res.message
   }
   ```

3. 解决 `.webp` 格式图片在 `ios` 设备上无法正常显示的问题：

   ```js
   // 定义请求商品详情数据的方法
   async getGoodsDetail(goods_id) {
     const { data: res } = await uni.$http.get('/api/public/v1/goods/detail', { goods_id })
     if (res.meta.status !== 200) return uni.$showMsg()
   
     // 使用字符串的 replace() 方法，将 webp 的后缀名替换为 jpg 的后缀名
     res.message.goods_introduce = res.message.goods_introduce.replace(/<img /g, '<img style="display:block;" ').replace(/webp/g, 'jpg')
     this.goods_info = res.message
   }
   ```

##### 4.5 解决商品价格闪烁的问题

1. 导致问题的原因：在商品详情数据请求回来之前，data 中 `goods_info` 的值为 `{}`，因此初次渲染页面时，

2. 会导致 `商品价格、商品名称` 等闪烁的问题。

3. 解决方案：判断 `goods_info.goods_name` 属性的值是否存在，从而使用 `v-if` 指令控制页面的显示与隐

   藏：

   ```xml
   <template>
     <view v-if="goods_info.goods_name">
      <!-- 省略其它代码 -->
     </view>
   </template>
   ```

#### 5、渲染详情页底部的商品导航区域

##### 5.1 渲染商品导航区域的 UI 结构

> 基于 uni-ui 提供的 [GoodsNav](https://ext.dcloud.net.cn/plugin?id=865) 组件来实现商品导航区域的效果

1. 在 data 中，通过 `options` 和 `buttonGroup` 两个数组，来声明商品导航组件的按钮配置对象：

   ```js
   data() {
     return {
       // 商品详情对象
       goods_info: {},
       // 左侧按钮组的配置对象
       options: [{
         icon: 'shop',
         text: '店铺'
       }, {
         icon: 'cart',
         text: '购物车',
         info: 2
       }],
       // 右侧按钮组的配置对象
       buttonGroup: [{
           text: '加入购物车',
           backgroundColor: '#ff0000',
           color: '#fff'
         },
         {
           text: '立即购买',
           backgroundColor: '#ffa200',
           color: '#fff'
         }
       ]
     }
   }
   ```

2. 在页面中使用 `uni-goods-nav` 商品导航组件：

   ```xml
   <!-- 商品导航组件 -->
   <view class="goods_nav">
     <!-- fill 控制右侧按钮的样式 -->
     <!-- options 左侧按钮的配置项 -->
     <!-- buttonGroup 右侧按钮的配置项 -->
     <!-- click 左侧按钮的点击事件处理函数 -->
     <!-- buttonClick 右侧按钮的点击事件处理函数 -->
     <uni-goods-nav :fill="true" :options="options" :buttonGroup="buttonGroup" @click="onClick" @buttonClick="buttonClick" />
   </view>
   ```

3. 美化商品导航组件，使之固定在页面最底部：

   ```scss
   .goods-detail-container {
     // 给页面外层的容器，添加 50px 的内padding，
     // 防止页面内容被底部的商品导航组件遮盖
     padding-bottom: 50px;
   }
   
   .goods_nav {
     // 为商品导航组件添加固定定位
     position: fixed;
     bottom: 0;
     left: 0;
     width: 100%;
   }
   ```

##### 5.2 点击跳转到购物车页面

1. 点击商品导航组件左侧的按钮，会触发 `uni-goods-nav` 的 `@click` 事件处理函数，事件对象 `e` 中会包含当

   前点击的按钮相关的信息：

   ```js
   // 左侧按钮的点击事件处理函数
   onClick(e) {
     console.log(e)
   }
   ```

   打印的按钮信息对象如下：

   ![img](data:image/png;base64,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)

2. 根据 `e.content.text` 的值，来决定进一步的操作：

   ```js
   // 左侧按钮的点击事件处理函数
   onClick(e) {
     if (e.content.text === '购物车') {
       // 切换到购物车页面
       uni.switchTab({
         url: '/pages/cart/cart'
       })
     }
   }
   ```

#### 6、分支的合并与提交

1. 将 `goodsdetail` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了商品详情页面的开发"
   ```

2. 将本地的 `goodsdetail` 分支推送到码云：

   ```bash
   git push -u origin goodsdetail
   ```

3. 将本地 `goodsdetail` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge goodsdetail
   git push
   ```

4. 删除本地的 `goodsdetail` 分支：

   ```bash
   git branch -d goodsdetail
   ```

# 加入购物车

#### 1、创建cart分支

运行如下的命令，基于 master 分支在本地创建 cart 子分支，用来开发购物车相关的功能：

```bash
git checkout -b cart
```

#### 2、配置vuex

1. 在项目根目录中创建 `store` 文件夹，专门用来存放 vuex 相关的模块

2. 在 `store` 目录上鼠标右键，选择 `新建 -> js文件`，新建 `store.js` 文件：

   ![img](data:image/png;base64,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)

3. 在 `store.js` 中按照如下 4 个步骤**初始化 Store 的实例对象**：

   ```js
   // 1. 导入 Vue 和 Vuex
   import Vue from 'vue'
   import Vuex from 'vuex'
   
   // 2. 将 Vuex 安装为 Vue 的插件
   Vue.use(Vuex)
   
   // 3. 创建 Store 的实例对象
   const store = new Vuex.Store({
     // TODO：挂载 store 模块
     modules: {},
   })
   
   // 4. 向外共享 Store 的实例对象
   export default store
   ```

4. 在 `main.js` 中导入 `store` 实例对象并挂载到 Vue 的实例上：

   ```js
   // 1. 导入 store 的实例对象
   import store from './store/store.js'
   
   // 省略其它代码...
   
   const app = new Vue({
     ...App,
     // 2. 将 store 挂载到 Vue 实例上
     store,
   })
   app.$mount()
   ```

#### 3、创建购物车的 store 模块

1. 在 `store` 目录上鼠标右键，选择 `新建 -> js文件`，创建购物车的 store 模块，命名为 `cart.js`：

   ![img](data:image/png;base64,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)

2. 在 `cart.js` 中，初始化如下的 vuex 模块：

   ```js
   export default {
     // 为当前模块开启命名空间
     namespaced: true,
   
     // 模块的 state 数据
     state: () => ({
       // 购物车的数组，用来存储购物车中每个商品的信息对象
       // 每个商品的信息对象，都包含如下 6 个属性：
       // { goods_id, goods_name, goods_price, goods_count, goods_small_logo, goods_state }
       cart: [],
     }),
   
     // 模块的 mutations 方法
     mutations: {},
   
     // 模块的 getters 属性
     getters: {},
   }
   ```

3. 在 `store/store.js` 模块中，导入并挂载购物车的 vuex 模块，示例代码如下：

   ```js
   import Vue from 'vue'
   import Vuex from 'vuex'
   // 1. 导入购物车的 vuex 模块
   import moduleCart from './cart.js'
   
   Vue.use(Vuex)
   
   const store = new Vuex.Store({
     // TODO：挂载 store 模块
     modules: {
       // 2. 挂载购物车的 vuex 模块，模块内成员的访问路径被调整为 m_cart，例如：
       //    购物车模块中 cart 数组的访问路径是 m_cart/cart
       m_cart: moduleCart,
     },
   })
   
   export default store
   ```

#### 4、在商品详情页中使用 Store 中的数据

1. 在 `goods_detail.vue` 页面中，修改 script 标签中的代码如下：

   ```js
   // 从 vuex 中按需导出 mapState 辅助方法
   import { mapState } from 'vuex'
   
   export default {
     computed: {
       // 调用 mapState 方法，把 m_cart 模块中的 cart 数组映射到当前页面中，作为计算属性来使用
       // ...mapState('模块的名称', ['要映射的数据名称1', '要映射的数据名称2'])
       ...mapState('m_cart', ['cart']),
     },
     // 省略其它代码...
   }
   ```

   > 注意：今后无论映射 mutations 方法，还是 getters 属性，还是 state 中的数据，都需要指定模块的名称，才能进行映射。

2. 在页面渲染时，可以直接使用映射过来的数据，例如：

   ```xml
   <!-- 运费 -->
   <view class="yf">快递：免运费 -- {{cart.length}}</view>
   ```

#### 5、实现加入购物车的功能

1. 在 store 目录下的 `cart.js` 模块中，封装一个将商品信息加入购物车的 mutations 方法，命名为 

   `addToCart`。示例代码如下：

   ```js
   export default {
     // 为当前模块开启命名空间
     namespaced: true,
   
     // 模块的 state 数据
     state: () => ({
       // 购物车的数组，用来存储购物车中每个商品的信息对象
       // 每个商品的信息对象，都包含如下 6 个属性：
       // { goods_id, goods_name, goods_price, goods_count, goods_small_logo, goods_state }
       cart: [],
     }),
   
     // 模块的 mutations 方法
     mutations: {
       addToCart(state, goods) {
         // 根据提交的商品的Id，查询购物车中是否存在这件商品
         // 如果不存在，则 findResult 为 undefined；否则，为查找到的商品信息对象
         const findResult = state.cart.find((x) => x.goods_id === goods.goods_id)
   
         if (!findResult) {
           // 如果购物车中没有这件商品，则直接 push
           state.cart.push(goods)
         } else {
           // 如果购物车中有这件商品，则只更新数量即可
           findResult.goods_count++
         }
       },
     },
   
     // 模块的 getters 属性
     getters: {},
   }
   ```

2. 在商品详情页面中，通过 `mapMutations` 这个辅助方法，把 vuex 中 `m_cart` 模块下的 `addToCart` 方法映射

   到当前页面：

   ```js
   // 按需导入 mapMutations 这个辅助方法
   import { mapMutations } from 'vuex'
   
   export default {
     methods: {
       // 把 m_cart 模块中的 addToCart 方法映射到当前页面使用
       ...mapMutations('m_cart', ['addToCart']),
     },
   }
   ```

3. 为商品导航组件 `uni-goods-nav` 绑定 `@buttonClick="buttonClick"` 事件处理函数：

   ```js
   // 右侧按钮的点击事件处理函数
   buttonClick(e) {
      // 1. 判断是否点击了 加入购物车 按钮
      if (e.content.text === '加入购物车') {
   
         // 2. 组织一个商品的信息对象
         const goods = {
            goods_id: this.goods_info.goods_id,       // 商品的Id
            goods_name: this.goods_info.goods_name,   // 商品的名称
            goods_price: this.goods_info.goods_price, // 商品的价格
            goods_count: 1,                           // 商品的数量
            goods_small_logo: this.goods_info.goods_small_logo, // 商品的图片
            goods_state: true                         // 商品的勾选状态
         }
   
         // 3. 通过 this 调用映射过来的 addToCart 方法，把商品信息对象存储到购物车中
         this.addToCart(goods)
   
      }
   }
   ```

#### 6、动态统计购物车中商品的总数量

1. 在 `cart.js` 模块中，在 `getters` 节点下定义一个 `total` 方法，用来统计购物车中商品的总数量：

   ```js
   // 模块的 getters 属性
   getters: {
      // 统计购物车中商品的总数量
      total(state) {
         let c = 0
         // 循环统计商品的数量，累加到变量 c 中
         state.cart.forEach(goods => c += goods.goods_count)
         return c
      }
   }
   ```

2. 在商品详情页面的 `script` 标签中，按需导入 `mapGetters` 方法并进行使用：

   ```js
   // 按需导入 mapGetters 这个辅助方法
   import { mapGetters } from 'vuex'
   
   export default {
     computed: {
       // 把 m_cart 模块中名称为 total 的 getter 映射到当前页面中使用
       ...mapGetters('m_cart', ['total']),
     },
   }
   ```

3. 通过 `watch` 侦听器，监听计算属性 `total` 值的变化，从而**动态为购物车按钮的徽标赋值**：

   ```js
   export default {
     watch: {
       // 1. 监听 total 值的变化，通过第一个形参得到变化后的新值
       total(newVal) {
         // 2. 通过数组的 find() 方法，找到购物车按钮的配置对象
         const findResult = this.options.find((x) => x.text === '购物车')
   
         if (findResult) {
           // 3. 动态为购物车按钮的 info 属性赋值
           findResult.info = newVal
         }
       },
     },
   }
   ```

#### 7、持久化存储购物车中的商品

1. 在 `cart.js` 模块中，声明一个叫做 `saveToStorage` 的 mutations 方法，此方法负责将购物车中的数据持久化存储到本地：

   ```js
   // 将购物车中的数据持久化存储到本地
   saveToStorage(state) {
      uni.setStorageSync('cart', JSON.stringify(state.cart))
   }
   ```

2. 修改 `mutations` 节点中的 `addToCart` 方法，在处理完商品信息后，调用步骤 1 中定义的 `saveToStorage` 方

   法：

   ```js
   addToCart(state, goods) {
      // 根据提交的商品的Id，查询购物车中是否存在这件商品
      // 如果不存在，则 findResult 为 undefined；否则，为查找到的商品信息对象
      const findResult = state.cart.find(x => x.goods_id === goods.goods_id)
   
      if (!findResult) {
         // 如果购物车中没有这件商品，则直接 push
         state.cart.push(goods)
      } else {
         // 如果购物车中有这件商品，则只更新数量即可
         findResult.goods_count++
      }
   
      // 通过 commit 方法，调用 m_cart 命名空间下的 saveToStorage 方法
      this.commit('m_cart/saveToStorage')
   }
   ```

3. 修改 `cart.js` 模块中的 `state` 函数，读取本地存储的购物车数据，对 cart 数组进行初始化：

   ```js
   // 模块的 state 数据
   state: () => ({
      // 购物车的数组，用来存储购物车中每个商品的信息对象
      // 每个商品的信息对象，都包含如下 6 个属性：
      // { goods_id, goods_name, goods_price, goods_count, goods_small_logo, goods_state }
      cart: JSON.parse(uni.getStorageSync('cart') || '[]')
   }),
   ```

#### 8、优化商品详情页的 total 侦听器

1. 使用**普通函数的形式**定义的 watch 侦听器，**在页面首次加载后不会被调用**。因此导致了商品详情页在首次

   加载完毕之后，不会将商品的总数量显示到商品导航区域：

   ```js
   watch: {
      // 页面首次加载完毕后，不会调用这个侦听器
      total(newVal) {
         const findResult = this.options.find(x => x.text === '购物车')
         if (findResult) {
            findResult.info = newVal
         }
      }
   }
   ```

2. 为了防止这个上述问题，可以使用**对象的形式**来定义 watch 侦听器

   （详细文档请参考 Vue 官方的 [watch 侦听器](https://cn.vuejs.org/v2/api/#watch)教程），示例代码如下：

   ```js
   watch: {
      // 定义 total 侦听器，指向一个配置对象
      total: {
         // handler 属性用来定义侦听器的 function 处理函数
         handler(newVal) {
            const findResult = this.options.find(x => x.text === '购物车')
            if (findResult) {
               findResult.info = newVal
            }
         },
         // immediate 属性用来声明此侦听器，是否在页面初次加载完毕后立即调用
         immediate: true
      }
   }
   ```

#### 9、动态为 tabBar 页面设置数字徽标

> 需求描述：从商品详情页面导航到购物车页面之后，需要为 tabBar 中的购物车动态设置数字徽标。

1. 把 Store 中的 total 映射到 `cart.vue` 中使用：

   ```js
   // 按需导入 mapGetters 这个辅助方法
   import { mapGetters } from 'vuex'
   
   export default {
     data() {
       return {}
     },
     computed: {
       // 将 m_cart 模块中的 total 映射为当前页面的计算属性
       ...mapGetters('m_cart', ['total']),
     },
   }
   ```

2. 在页面刚显示出来的时候，立即调用 `setBadge` 方法，为 tabBar 设置数字徽标：

   ```js
   onShow() {
      // 在页面刚展示的时候，设置数字徽标
      this.setBadge()
   }
   ```

3. 在 `methods` 节点中，声明 `setBadge` 方法如下，通过 `uni.setTabBarBadge()` 为 tabBar 设置数字徽标：

   ```js
   methods: {
      setBadge() {
         // 调用 uni.setTabBarBadge() 方法，为购物车设置右上角的徽标
         uni.setTabBarBadge({
            index: 2, // 索引
            text: this.total + '' // 注意：text 的值必须是字符串，不能是数字
         })
      }
   }
   ```

#### 10、将设置 tabBar 徽标的代码抽离为 mixins

> 注意：除了要在 cart.vue 页面中设置购物车的数字徽标，还需要在其它 3 个 tabBar 页面中，为购物车设置数字徽标。

> 此时可以使用 Vue 提供的 [mixins](https://cn.vuejs.org/v2/guide/mixins.html) 特性，提高代码的可维护性。

1. 在项目根目录中新建 `mixins` 文件夹，并在 `mixins` 文件夹之下新建 `tabbar-badge.js` 文件，用来把设置 

   tabBar 徽标的代码封装为一个 mixin 文件：

   ```js
   import { mapGetters } from 'vuex'
   
   // 导出一个 mixin 对象
   export default {
     computed: {
       ...mapGetters('m_cart', ['total']),
     },
     onShow() {
       // 在页面刚展示的时候，设置数字徽标
       this.setBadge()
     },
     methods: {
       setBadge() {
         // 调用 uni.setTabBarBadge() 方法，为购物车设置右上角的徽标
         uni.setTabBarBadge({
           index: 2,
           text: this.total + '', // 注意：text 的值必须是字符串，不能是数字
         })
       },
     },
   }
   ```

2. 修改 `home.vue`，`cate.vue`，`cart.vue`，`my.vue` 这 4 个 tabBar 页面的源代码，分别导入 `@/mixins/tabbar-`

   `badge.js` 模块并进行使用：

   ```js
   // 导入自己封装的 mixin 模块
   import badgeMix from '@/mixins/tabbar-badge.js'
   
   export default {
     // 将 badgeMix 混入到当前的页面中进行使用
     mixins: [badgeMix],
     // 省略其它代码...
   }
   ```

# 购物车页面

#### 1、商品列表区域

##### 1.1 渲染购物车商品列表的标题区域

1. 定义如下的 UI 结构：

   ```xml
   <!-- 购物车商品列表的标题区域 -->
   <view class="cart-title">
     <!-- 左侧的图标 -->
     <uni-icons type="shop" size="18"></uni-icons>
     <!-- 描述文本 -->
     <text class="cart-title-text">购物车</text>
   </view>
   ```

2. 美化样式：

   ```scss
   .cart-title {
     height: 40px;
     display: flex;
     align-items: center;
     font-size: 14px;
     padding-left: 5px;
     border-bottom: 1px solid #efefef;
     .cart-title-text {
       margin-left: 10px;
     }
   }
   ```

##### 1.2 渲染商品列表区域的基本结构

1. 通过 `mapState` 辅助函数，将 Store 中的 `cart` 数组映射到当前页面中使用：

   ```js
   import badgeMix from '@/mixins/tabbar-badge.js'
   // 按需导入 mapState 这个辅助函数
   import { mapState } from 'vuex'
   
   export default {
     mixins: [badgeMix],
     computed: {
       // 将 m_cart 模块中的 cart 数组映射到当前页面中使用
       ...mapState('m_cart', ['cart']),
     },
     data() {
       return {}
     },
   }
   ```

2. 在 UI 结构中，通过 `v-for` 指令循环渲染自定义的 `my-goods` 组件：

   ```xml
   <!-- 商品列表区域 -->
   <block v-for="(goods, i) in cart" :key="i">
     <my-goods :goods="goods"></my-goods>
   </block>
   ```

##### 1.3 为 my-goods 组件封装 radio 勾选状态

1. 打开 `my-goods.vue` 组件的源代码，为商品的左侧图片区域添加 `radio` 组件：

   ```xml
   <!-- 商品左侧图片区域 -->
   <view class="goods-item-left">
     <radio checked color="#C00000"></radio>
     <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
   </view>
   ```

2. 给类名为 `goods-item-left` 的 `view` 组件添加样式，实现 `radio` 组件和 `image` 组件的左右布局：

   ```css
   .goods-item-left {
     margin-right: 5px;
     display: flex;
     justify-content: space-between;
     align-items: center;
   
     .goods-pic {
       width: 100px;
       height: 100px;
       display: block;
     }
   }
   ```

3. 封装名称为 `showRadio` 的 `props` 属性，来控制当前组件中是否显示 radio 组件：

   ```js
   export default {
     // 定义 props 属性，用来接收外界传递到当前组件的数据
     props: {
       // 商品的信息对象
       goods: {
         type: Object,
         default: {},
       },
       // 是否展示图片左侧的 radio
       showRadio: {
         type: Boolean,
         // 如果外界没有指定 show-radio 属性的值，则默认不展示 radio 组件
         default: false,
       },
     },
   }
   ```

4. 使用 `v-if` 指令控制 `radio` 组件的按需展示：

   ```xml
   <!-- 商品左侧图片区域 -->
   <view class="goods-item-left">
     <!-- 使用 v-if 指令控制 radio 组件的显示与隐藏 -->
     <radio checked color="#C00000" v-if="showRadio"></radio>
     <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
   </view>
   ```

5. 在 `cart.vue` 页面中的商品列表区域，指定 `:show-radio="true"` 属性，从而显示 radio 组件：

   ```xml
   <!-- 商品列表区域 -->
   <block v-for="(goods, i) in cart" :key="i">
     <my-goods :goods="goods" :show-radio="true"></my-goods>
   </block>
   ```

6. 修改 `my-goods.vue` 组件，动态为 `radio` 绑定选中状态：

   ```xml
   <!-- 商品左侧图片区域 -->
   <view class="goods-item-left">
     <!-- 存储在购物车中的商品，包含 goods_state 属性，表示商品的勾选状态 -->
     <radio :checked="goods.goods_state" color="#C00000" v-if="showRadio"></radio>
     <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
   </view>
   ```

##### 1.4 为 my-goods 组件封装 radio-change 事件

1. 当用户点击 radio 组件，**希望修改当前商品的勾选状态**，此时用户可以为 `my-goods` 组件绑定 `@radio-`

   `change` 事件，从而获取当前商品的 `goods_id` 和 `goods_state`：

   ```xml
   <!-- 商品列表区域 -->
   <block v-for="(goods, i) in cart" :key="i">
     <!-- 在 radioChangeHandler 事件处理函数中，通过事件对象 e，得到商品的 goods_id 和 goods_state -->
     <my-goods :goods="goods" :show-radio="true" @radio-change="radioChangeHandler"></my-goods>
   </block>
   ```

   定义 `radioChangeHandler` 事件处理函数如下：

   ```js
   methods: {
     // 商品的勾选状态发生了变化
     radioChangeHandler(e) {
       console.log(e) // 输出得到的数据 -> {goods_id: 395, goods_state: false}
     }
   }
   ```

2. 在 `my-goods.vue` 组件中，为 `radio` 组件绑定 `@click` 事件处理函数如下：

   ```xml
   <!-- 商品左侧图片区域 -->
   <view class="goods-item-left">
     <radio :checked="goods.goods_state" color="#C00000" v-if="showRadio" @click="radioClickHandler"></radio>
     <image :src="goods.goods_small_logo || defaultPic" class="goods-pic"></image>
   </view>
   ```

3. 在 `my-goods.vue` 组件的 methods 节点中，定义 `radioClickHandler` 事件处理函数：

   ```js
   methods: {
     // radio 组件的点击事件处理函数
     radioClickHandler() {
       // 通过 this.$emit() 触发外界通过 @ 绑定的 radio-change 事件，
       // 同时把商品的 Id 和 勾选状态 作为参数传递给 radio-change 事件处理函数
       this.$emit('radio-change', {
         // 商品的 Id
         goods_id: this.goods.goods_id,
         // 商品最新的勾选状态
         goods_state: !this.goods.goods_state
       })
     }
   }
   ```

##### 1.5 修改购物车中商品的勾选状态

1. 在 `store/cart.js` 模块中，声明如下的 `mutations` 方法，用来修改对应商品的勾选状态：

   ```js
   // 更新购物车中商品的勾选状态
   updateGoodsState(state, goods) {
     // 根据 goods_id 查询购物车中对应商品的信息对象
     const findResult = state.cart.find(x => x.goods_id === goods.goods_id)
   
     // 有对应的商品信息对象
     if (findResult) {
       // 更新对应商品的勾选状态
       findResult.goods_state = goods.goods_state
       // 持久化存储到本地
       this.commit('m_cart/saveToStorage')
     }
   }
   ```

2. 在 `cart.vue` 页面中，导入 `mapMutations` 这个辅助函数，从而将需要的 mutations 方法映射到当前页面中

   使用：

   ```js
   import badgeMix from '@/mixins/tabbar-badge.js'
   import { mapState, mapMutations } from 'vuex'
   
   export default {
     mixins: [badgeMix],
     computed: {
       ...mapState('m_cart', ['cart']),
     },
     data() {
       return {}
     },
     methods: {
       ...mapMutations('m_cart', ['updateGoodsState']),
       // 商品的勾选状态发生了变化
       radioChangeHandler(e) {
         this.updateGoodsState(e)
       },
     },
   }
   ```

##### 1.6  为 my-goods 组件封装 NumberBox

> 注意：[NumberBox](https://ext.dcloud.net.cn/plugin?id=31) 组件是 uni-ui 提供的

1. 修改 `my-goods.vue` 组件的源代码，在类名为 `goods-info-box` 的 view 组件内部渲染 `NumberBox` 组件的基

   本结构：

   ```xml
   <view class="goods-info-box">
     <!-- 商品价格 -->
     <view class="goods-price">￥{{goods.goods_price | tofixed}}</view>
     <!-- 商品数量 -->
     <uni-number-box :min="1"></uni-number-box>
   </view>
   ```

2. 美化页面的结构：

   ```scss
   .goods-item-right {
     display: flex;
     flex: 1;
     flex-direction: column;
     justify-content: space-between;
   
     .goods-name {
       font-size: 13px;
     }
   
     .goods-info-box {
       display: flex;
       align-items: center;
       justify-content: space-between;
     }
   
     .goods-price {
       font-size: 16px;
       color: #c00000;
     }
   }
   ```

3. 在 `my-goods.vue` 组件中，动态为 `NumberBox` 组件绑定商品的数量值：

   ```xml
   <view class="goods-info-box">
     <!-- 商品价格 -->
     <view class="goods-price">￥{{goods.goods_price | tofixed}}</view>
     <!-- 商品数量 -->
     <uni-number-box :min="1" :value="goods.goods_count"></uni-number-box>
   </view>
   ```

4. 在 `my-goods.vue` 组件中，封装名称为 `showNum` 的 `props` 属性，来控制当前组件中是否显示 `NumberBox` 组

   件：

   ```js
   export default {
     // 定义 props 属性，用来接收外界传递到当前组件的数据
     props: {
       // 商品的信息对象
       goods: {
         type: Object,
         defaul: {},
       },
       // 是否展示图片左侧的 radio
       showRadio: {
         type: Boolean,
         // 如果外界没有指定 show-radio 属性的值，则默认不展示 radio 组件
         default: false,
       },
       // 是否展示价格右侧的 NumberBox 组件
       showNum: {
         type: Boolean,
         default: false,
       },
     },
   }
   ```

5. 在 `my-goods.vue` 组件中，使用 `v-if` 指令控制 `NumberBox` 组件的按需展示：

   ```xml
   <view class="goods-info-box">
     <!-- 商品价格 -->
     <view class="goods-price">￥{{goods.goods_price | tofixed}}</view>
     <!-- 商品数量 -->
     <uni-number-box :min="1" :value="goods.goods_count" @change="numChangeHandler" v-if="showNum"></uni-number-box>
   </view>
   ```

6. 在 `cart.vue` 页面中的商品列表区域，指定 `:show-num="true"` 属性，从而显示 `NumberBox` 组件：

   ```xml
   <!-- 商品列表区域 -->
   <block v-for="(goods, i) in cart" :key="i">
     <my-goods :goods="goods" :show-radio="true" :show-num="true" @radio-change="radioChangeHandler"></my-goods>
   </block>
   ```

##### 1.7 为 my-goods 组件封装 num-change 事件

1. 当用户修改了 `NumberBox` 的值以后，希望将最新的商品数量更新到购物车中，此时用户可以为 `my-goods` 

   组件绑定 `@num-change`事件，从而获取当前商品的 `goods_id` 和 `goods_count：

   ```xml
   <!-- 商品列表区域 -->
   <block v-for="(goods, i) in cart" :key="i">
     <my-goods :goods="goods" :show-radio="true" :show-num="true" @radio-change="radioChangeHandler" @num-change="numberChangeHandler"></my-goods>
   </block>
   ```

   定义 `numberChangeHandler` 事件处理函数如下：

   ```js
   // 商品的数量发生了变化
   numberChangeHandler(e) {
     console.log(e)
   }
   ```

2. 在 `my-goods.vue` 组件中，为 `uni-number-box` 组件绑定 `@change` 事件处理函数如下：

   ```xml
   <view class="goods-info-box">
     <!-- 商品价格 -->
     <view class="goods-price">￥{{goods.goods_price | tofixed}}</view>
     <!-- 商品数量 -->
     <uni-number-box :min="1" :value="goods.goods_count" @change="numChangeHandler"></uni-number-box>
   </view>
   ```

3. 在 `my-goods.vue` 组件的 `methods` 节点中，定义 `numChangeHandler` 事件处理函数：

   ```js
   methods: {
     // NumberBox 组件的 change 事件处理函数
     numChangeHandler(val) {
       // 通过 this.$emit() 触发外界通过 @ 绑定的 num-change 事件
       this.$emit('num-change', {
         // 商品的 Id
         goods_id: this.goods.goods_id,
         // 商品的最新数量
         goods_count: +val
       })
     }
   }
   ```

##### 1.9 解决 NumberBox 数据不合法的问题

> 问题说明：当用户在 NumberBox 中输入字母等非法字符之后，会导致 NumberBox 数据紊乱的问题

1. 打开项目根目录中 `components/uni-number-box/uni-number-box.vue` 组件，修改 `methods` 节点中的 

   _onBlur 函数如下：

   ```js
   _onBlur(event) {
     // 官方的代码没有进行数值转换，用户输入的 value 值可能是非法字符：
     // let value = event.detail.value;
   
     // 将用户输入的内容转化为整数
     let value = parseInt(event.detail.value);
   
     if (!value) {
       // 如果转化之后的结果为 NaN，则给定默认值为 1
       this.inputValue = 1;
       return;
     }
   
     // 省略其它代码...
   }
   ```

2. 修改完毕之后，用户输入**小数**会**被转化为整数**，用户输入**非法字符**会**被替换为默认值 1**

##### 1.10 完善 NumberBox 的 inputValue 侦听器

> 问题说明：在用户每次输入内容之后，都会触发 inputValue 侦听器，从而调用 this.$emit("change", newVal) 方法。这种做法可能会把不合法的内容传递出去！

1. 打开项目根目录中 `components/uni-number-box/uni-number-box.vue` 组件，修改 `watch` 节点中的 

   `inputValue` 侦听器如下：

   ```js
   inputValue(newVal, oldVal) {
     // 官方提供的 if 判断条件，在用户每次输入内容时，都会调用 this.$emit("change", newVal)
     // if (+newVal !== +oldVal) {
   
     // 新旧内容不同 && 新值内容合法 && 新值中不包含小数点
     if (+newVal !== +oldVal && Number(newVal) && String(newVal).indexOf('.') === -1) {
       this.$emit("change", newVal);
     }
   }
   ```

2. 修改完毕之后，NumberBox 组件只会把**合法的、且不包含小数点的新值**传递出去

##### 1.11 修改购物车中商品的数量

1. 在 `store/cart.js` 模块中，声明如下的 mutations 方法，用来修改对应商品的数量：

   ```js
   // 更新购物车中商品的数量
   updateGoodsCount(state, goods) {
     // 根据 goods_id 查询购物车中对应商品的信息对象
     const findResult = state.cart.find(x => x.goods_id === goods.goods_id)
   
     if(findResult) {
       // 更新对应商品的数量
       findResult.goods_count = goods.goods_count
       // 持久化存储到本地
       this.commit('m_cart/saveToStorage')
     }
   }
   ```

2. 在 `cart.vue` 页面中，通过 `mapMutations` 这个辅助函数，将需要的 `mutations` 方法映射到当前页面中使

   用：

   ```js
   import badgeMix from '@/mixins/tabbar-badge.js'
   import { mapState, mapMutations } from 'vuex'
   
   export default {
     mixins: [badgeMix],
     computed: {
       ...mapState('m_cart', ['cart']),
     },
     data() {
       return {}
     },
     methods: {
       ...mapMutations('m_cart', ['updateGoodsState', 'updateGoodsCount']),
       // 商品的勾选状态发生了变化
       radioChangeHandler(e) {
         this.updateGoodsState(e)
       },
       // 商品的数量发生了变化
       numberChangeHandler(e) {
         this.updateGoodsCount(e)
       },
     },
   }
   ```

##### 1.12  渲染滑动删除的 UI 效果

> 滑动删除需要用到 uni-ui 的 uni-swipe-action 组件和 uni-swipe-action-item。详细的官方文档请参考[SwipeAction 滑动操作](https://ext.dcloud.net.cn/plugin?id=181)。

1. 改造 `cart.vue` 页面的 UI 结构，将商品列表区域的结构修改如下（可以使用 **uSwipeAction** 代码块快速生

   成基本的 UI 结构）：

   ```xml
   <!-- 商品列表区域 -->
   <!-- uni-swipe-action 是最外层包裹性质的容器 -->
   <uni-swipe-action>
     <block v-for="(goods, i) in cart" :key="i">
       <!-- uni-swipe-action-item 可以为其子节点提供滑动操作的效果。需要通过 options 属性来指定操作按钮的配置信息 -->
       <uni-swipe-action-item :options="options" @click="swipeActionClickHandler(goods)">
         <my-goods :goods="goods" :show-radio="true" :show-num="true" @radio-change="radioChangeHandler" @num-change="numberChangeHandler"></my-goods>
       </uni-swipe-action-item>
     </block>
   </uni-swipe-action>
   ```

2. 在 data 节点中声明 `options` 数组，用来定义操作按钮的配置信息：

   ```js
   data() {
     return {
       options: [{
         text: '删除', // 显示的文本内容
         style: {
           backgroundColor: '#C00000' // 按钮的背景颜色
         }
       }]
     }
   }
   ```

3. 在 `methods` 中声明 `uni-swipe-action-item` 组件的 `@click` 事件处理函数：

   ```js
   // 点击了滑动操作按钮
   swipeActionClickHandler(goods) {
     console.log(goods)
   }
   ```

4. 美化 `my-goods.vue` 组件的样式：

   ```scss
   .goods-item {
     // 让 goods-item 项占满整个屏幕的宽度
     width: 750rpx;
     // 设置盒模型为 border-box
     box-sizing: border-box;
     display: flex;
     padding: 10px 5px;
     border-bottom: 1px solid #f0f0f0;
   }
   ```

##### 1.13 实现滑动删除的功能

1. 在 `store/cart.js` 模块的 `mutations` 节点中声明如下的方法，从而根据商品的 Id 从购物车中移除对应的商品：

   ```js
   // 根据 Id 从购物车中删除对应的商品信息
   removeGoodsById(state, goods_id) {
     // 调用数组的 filter 方法进行过滤
     state.cart = state.cart.filter(x => x.goods_id !== goods_id)
     // 持久化存储到本地
     this.commit('m_cart/saveToStorage')
   }
   ```

2. 在 `cart.vue` 页面中，使用 `mapMutations` 辅助函数，把需要的方法映射到当前页面中使用：

   ```js
   methods: {
     ...mapMutations('m_cart', ['updateGoodsState', 'updateGoodsCount', 'removeGoodsById']),
     // 商品的勾选状态发生了变化
     radioChangeHandler(e) {
       this.updateGoodsState(e)
     },
     // 商品的数量发生了变化
     numberChangeHandler(e) {
       this.updateGoodsCount(e)
     },
     // 点击了滑动操作按钮
     swipeActionClickHandler(goods) {
       this.removeGoodsById(goods.goods_id)
     }
   }
   ```

#### 2、收货地址区域

##### 2.1 创建收货地址组件

1. 在 `components` 目录上鼠标右键，选择 `新建组件`，并填写组件相关的信息：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/9-3.d168684c.png)

2. 渲染收货地址组件的基本结构：

   ```xml
   <view>
   
     <!-- 选择收货地址的盒子 -->
     <view class="address-choose-box">
       <button type="primary" size="mini" class="btnChooseAddress">请选择收货地址+</button>
     </view>
   
     <!-- 渲染收货信息的盒子 -->
     <view class="address-info-box">
       <view class="row1">
         <view class="row1-left">
           <view class="username">收货人：<text>escook</text></view>
         </view>
         <view class="row1-right">
           <view class="phone">电话：<text>138XXXX5555</text></view>
           <uni-icons type="arrowright" size="16"></uni-icons>
         </view>
       </view>
       <view class="row2">
         <view class="row2-left">收货地址：</view>
         <view class="row2-right">河北省邯郸市肥乡区xxx 河北省邯郸市肥乡区xxx 河北省邯郸市肥乡区xxx 河北省邯郸市肥乡区xxx </view>
       </view>
     </view>
   
     <!-- 底部的边框线 -->
     <image src="/static/cart_border@2x.png" class="address-border"></image>
   </view>
   ```

3. 美化收货地址组件的样式：

   ```scss
   // 底部边框线的样式
   .address-border {
     display: block;
     width: 100%;
     height: 5px;
   }
   
   // 选择收货地址的盒子
   .address-choose-box {
     height: 90px;
     display: flex;
     align-items: center;
     justify-content: center;
   }
   
   // 渲染收货信息的盒子
   .address-info-box {
     font-size: 12px;
     height: 90px;
     display: flex;
     flex-direction: column;
     justify-content: center;
     padding: 0 5px;
   
     // 第一行
     .row1 {
       display: flex;
       justify-content: space-between;
   
       .row1-right {
         display: flex;
         align-items: center;
   
         .phone {
           margin-right: 5px;
         }
       }
     }
   
     // 第二行
     .row2 {
       display: flex;
       align-items: center;
       margin-top: 10px;
   
       .row2-left {
         white-space: nowrap;
       }
     }
   }
   ```

##### 2.2 实现收货地址区域的按需展示

1. 在 data 中定义收货地址的信息对象：

   ```js
   export default {
     data() {
       return {
         // 收货地址
         address: {},
       }
     },
   }
   ```

2. 使用 `v-if` 和 `v-else` 实现按需展示：

   ```xml
   <!-- 选择收货地址的盒子 -->
   <view class="address-choose-box" v-if="JSON.stringify(address) === '{}'">
     <button type="primary" size="mini" class="btnChooseAddress">请选择收货地址+</button>
   </view>
   
   <!-- 渲染收货信息的盒子 -->
   <view class="address-info-box" v-else>
     <!-- 省略其它代码 -->
   </view>
   ```

##### 2.3 实现选择收货地址的功能

1. 为 `请选择收货地址+` 的 `button` 按钮绑定点击事件处理函数：

   ```xml
   <!-- 选择收货地址的盒子 -->
   <view class="address-choose-box" v-if="JSON.stringify(address) === '{}'">
     <button type="primary" size="mini" class="btnChooseAddress" @click="chooseAddress">请选择收货地址+</button>
   </view>
   ```

2. 定义 `chooseAddress` 事件处理函数，调用小程序提供的 `chooseAddress()` API 实现选择收货地址的功能：

   ```js
   methods: {
     // 选择收货地址
     async chooseAddress() {
       // 1. 调用小程序提供的 chooseAddress() 方法，即可使用选择收货地址的功能
       //    返回值是一个数组：第 1 项为错误对象；第 2 项为成功之后的收货地址对象
       const [err, succ] = await uni.chooseAddress().catch(err => err)
   
       // 2. 用户成功的选择了收货地址
       if (err === null && succ.errMsg === 'chooseAddress:ok') {
         // 为 data 里面的收货地址对象赋值
         this.address = succ
       }
     }
   }
   ```

3. 定义**收货详细地址**的计算属性：

   ```js
   computed: {
     // 收货详细地址的计算属性
     addstr() {
       if (!this.address.provinceName) return ''
   
       // 拼接 省，市，区，详细地址 的字符串并返回给用户
       return this.address.provinceName + this.address.cityName + this.address.countyName + this.address.detailInfo
     }
   }
   ```

4. 渲染收货地址区域的数据：

   ```xml
   <!-- 渲染收货信息的盒子 -->
   <view class="address-info-box" v-else>
     <view class="row1">
       <view class="row1-left">
         <view class="username">收货人：<text>{{address.userName}}</text></view>
       </view>
       <view class="row1-right">
         <view class="phone">电话：<text>{{address.telNumber}}</text></view>
         <uni-icons type="arrowright" size="16"></uni-icons>
       </view>
     </view>
     <view class="row2">
       <view class="row2-left">收货地址：</view>
       <view class="row2-right">{{addstr}}</view>
     </view>
   </view>
   ```

##### 2.4 将 address 信息存储到 vuex 中

1. 在 `store` 目录中，创建用户相关的 `vuex` 模块，命名为 `user.js`：

   ```js
   export default {
     // 开启命名空间
     namespaced: true,
   
     // state 数据
     state: () => ({
       // 收货地址
       address: {},
     }),
   
     // 方法
     mutations: {
       // 更新收货地址
       updateAddress(state, address) {
         state.address = address
       },
     },
   
     // 数据包装器
     getters: {},
   }
   ```

2. 在 `store/store.js` 模块中，导入并挂载 `user.js` 模块：

   ```js
   // 1. 导入 Vue 和 Vuex
   import Vue from 'vue'
   import Vuex from 'vuex'
   // 导入购物车的 vuex 模块
   import moduleCart from './cart.js'
   // 导入用户的 vuex 模块
   import moduleUser from './user.js'
   
   // 2. 将 Vuex 安装为 Vue 的插件
   Vue.use(Vuex)
   
   // 3. 创建 Store 的实例对象
   const store = new Vuex.Store({
     // TODO：挂载 store 模块
     modules: {
       // 挂载购物车的 vuex 模块，模块内成员的访问路径被调整为 m_cart，例如：
       // 购物车模块中 cart 数组的访问路径是 m_cart/cart
       m_cart: moduleCart,
       // 挂载用户的 vuex 模块，访问路径为 m_user
       m_user: moduleUser,
     },
   })
   
   // 4. 向外共享 Store 的实例对象
   export default store
   ```

3. 改造 `address.vue` 组件中的代码，使用 **vuex 提供的 address 计算属性** 替代 **data 中定义的本地 address 对**

   **象**：

   ```js
   // 1. 按需导入 mapState 和 mapMutations 这两个辅助函数
   import { mapState, mapMutations } from 'vuex'
   
   export default {
     data() {
       return {
         // 2.1 注释掉下面的 address 对象，使用 2.2 中的代码替代之
         // address: {}
       }
     },
     methods: {
       // 3.1 把 m_user 模块中的 updateAddress 函数映射到当前组件
       ...mapMutations('m_user', ['updateAddress']),
       // 选择收货地址
       async chooseAddress() {
         const [err, succ] = await uni.chooseAddress().catch((err) => err)
   
         // 用户成功的选择了收货地址
         if (err === null && succ.errMsg === 'chooseAddress:ok') {
           // 3.2 把下面这行代码注释掉，使用 3.3 中的代码替代之
           // this.address = succ
   
           // 3.3 调用 Store 中提供的 updateAddress 方法，将 address 保存到 Store 里面
           this.updateAddress(succ)
         }
       },
     },
     computed: {
       // 2.2 把 m_user 模块中的 address 对象映射当前组件中使用，代替 data 中 address 对象
       ...mapState('m_user', ['address']),
       // 收货详细地址的计算属性
       addstr() {
         if (!this.address.provinceName) return ''
   
         // 拼接 省，市，区，详细地址 的字符串并返回给用户
         return this.address.provinceName + this.address.cityName + this.address.countyName + this.address.detailInfo
       },
     },
   }
   ```

##### 2.5 将 Store 中的 address 持久化存储到本地

修改 `store/user.js` 模块中的代码如下：

```js
export default {
  // 开启命名空间
  namespaced: true,

  // state 数据
  state: () => ({
    // 3. 读取本地的收货地址数据，初始化 address 对象
    address: JSON.parse(uni.getStorageSync('address') || '{}'),
  }),

  // 方法
  mutations: {
    // 更新收货地址
    updateAddress(state, address) {
      state.address = address

      // 2. 通过 this.commit() 方法，调用 m_user 模块下的 saveAddressToStorage 方法将 address 对象持久化存储到本地
      this.commit('m_user/saveAddressToStorage')
    },
    // 1. 定义将 address 持久化存储到本地 mutations 方法
    saveAddressToStorage(state) {
      uni.setStorageSync('address', JSON.stringify(state.address))
    },
  },

  // 数据包装器
  getters: {},
}
```

##### 2.6 将 addstr 抽离为 getters

> 目的：为了提高代码的复用性，可以把收货的详细地址抽离为 getters，方便在多个页面和组件之间实现复用。

1. 剪切 `my-address.vue` 组件中的 `addstr` 计算属性的代码，粘贴到 `user.js` 模块中，作为一个 getters 节点：

   ```js
   // 数据包装器
   getters: {
     // 收货详细地址的计算属性
     addstr(state) {
       if (!state.address.provinceName) return ''
   
       // 拼接 省，市，区，详细地址 的字符串并返回给用户
       return state.address.provinceName + state.address.cityName + state.address.countyName + state.address.detailInfo
     }
   }
   ```

2. 改造 `my-address.vue` 组件中的代码，通过 `mapGetters` 辅助函数，将 `m_user` 模块中的 `addstr` 映射到当前

   组件中使用：

   ```js
   // 按需导入 mapGetters 辅助函数
   import { mapState, mapMutations, mapGetters } from 'vuex'
   
   export default {
     // 省略其它代码
     computed: {
       ...mapState('m_user', ['address']),
       // 将 m_user 模块中的 addstr 映射到当前组件中使用
       ...mapGetters('m_user', ['addstr']),
     },
   }
   ```

##### 2.7 重新选择收货地址

为 class 类名为 `address-info-box` 的盒子绑定 `click` 事件处理函数如下：

```xml
<!-- 渲染收货信息的盒子 -->
<view class="address-info-box" v-else @click="chooseAddress">
  <!-- 省略其它代码 -->
</view>
```

##### 2.8 解决收货地址授权失败的问题

> 如果在选择收货地址的时候，用户点击了**取消授权**，则需要进行**特殊的处理**，否则**用户将无法再次选择收货地址**！

1. 改造 `chooseAddress` 方法如下：s

   ```js
   // 选择收货地址
   async chooseAddress() {
     // 1. 调用小程序提供的 chooseAddress() 方法，即可使用选择收货地址的功能
     //    返回值是一个数组：第1项为错误对象；第2项为成功之后的收货地址对象
     const [err, succ] = await uni.chooseAddress().catch(err => err)
   
     // 2. 用户成功的选择了收货地址
     if (succ && succ.errMsg === 'chooseAddress:ok') {
       // 更新 vuex 中的收货地址
       this.updateAddress(succ)
     }
   
     // 3. 用户没有授权
     if (err && err.errMsg === 'chooseAddress:fail auth deny') {
       this.reAuth() // 调用 this.reAuth() 方法，向用户重新发起授权申请
     }
   }
   ```

2. 在 `methods` 节点中声明 `reAuth` 方法如下：

   ```js
   // 调用此方法，重新发起收货地址的授权
   async reAuth() {
     // 3.1 提示用户对地址进行授权
     const [err2, confirmResult] = await uni.showModal({
       content: '检测到您没打开地址权限，是否去设置打开？',
       confirmText: "确认",
       cancelText: "取消",
     })
   
     // 3.2 如果弹框异常，则直接退出
     if (err2) return
   
     // 3.3 如果用户点击了 “取消” 按钮，则提示用户 “您取消了地址授权！”
     if (confirmResult.cancel) return uni.$showMsg('您取消了地址授权！')
   
     // 3.4 如果用户点击了 “确认” 按钮，则调用 uni.openSetting() 方法进入授权页面，让用户重新进行授权
     if (confirmResult.confirm) return uni.openSetting({
       // 3.4.1 授权结束，需要对授权的结果做进一步判断
       success: (settingResult) => {
         // 3.4.2 地址授权的值等于 true，提示用户 “授权成功”
         if (settingResult.authSetting['scope.address']) return uni.$showMsg('授权成功！请选择地址')
         // 3.4.3 地址授权的值等于 false，提示用户 “您取消了地址授权”
         if (!settingResult.authSetting['scope.address']) return uni.$showMsg('您取消了地址授权！')
       }
     })
   }
   ```

##### 2.9 解决 iPhone 真机上无法重新授权的问题

> 问题说明：在 iPhone 设备上，当用户取消授权之后，再次点击选择收货地址按钮的时候，无法弹出授权的提示框！

1. 导致问题的原因 - 用户取消授权后，再次点击 “选择收货地址” 按钮的时候：

   - 在**模拟器**和**安卓真机**上，错误消息 `err.errMsg` 的值为 `chooseAddress:fail auth deny`
   - 在 **iPhone 真机**上，错误消息 `err.errMsg` 的值为 `chooseAddress:fail authorize no response`

2. 解决问题的方案 - 修改 `chooseAddress` 方法中的代码，进一步完善用户没有授权时的 `if` 判断条件即可：

   ```js
   async chooseAddress() {
     // 1. 调用小程序提供的 chooseAddress() 方法，即可使用选择收货地址的功能
     //    返回值是一个数组：第1项为错误对象；第2项为成功之后的收货地址对象
     const [err, succ] = await uni.chooseAddress().catch(err => err)
   
     // 2. 用户成功的选择了收货地址
     if (succ && succ.errMsg === 'chooseAddress:ok') {
       this.updateAddress(succ)
     }
   
     // 3. 用户没有授权
     if (err && (err.errMsg === 'chooseAddress:fail auth deny' || err.errMsg === 'chooseAddress:fail authorize no response')) {
       this.reAuth()
     }
   }
   ```

#### 3、结算区域

##### 3.1 把结算区域封装为组件

1. 在 `components` 目录中，新建 `my-settle` 结算组件：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/9-4.1739d570.png)

2. 初始化 `my-settle` 组件的基本结构和样式：

   ```vue
   <template>
     <!-- 最外层的容器 -->
     <view class="my-settle-container">
       结算组件
     </view>
   </template>
   
   <script>
   export default {
     data() {
       return {}
     },
   }
   </script>
   
   <style lang="scss">
   .my-settle-container {
     /* 底部固定定位 */
     position: fixed;
     bottom: 0;
     left: 0;
     /* 设置宽高和背景色 */
     width: 100%;
     height: 50px;
     background-color: cyan;
   }
   </style>
   ```

3. 在 `cart.vue` 页面中使用自定义的 `my-settle` 组件，并美化页面样式，防止页面底部被覆盖：

   ```vue
   <template>
     <view class="cart-container">
       <!-- 使用自定义的 address 组件 -->
   
       <!-- 购物车商品列表的标题区域 -->
   
       <!-- 商品列表区域 -->
   
       <!-- 结算区域 -->
       <my-settle></my-settle>
     </view>
   </template>
   
   <style lang="scss">
   .cart-container {
     padding-bottom: 50px;
   }
   </style>
   ```

##### 3.2 渲染结算区域的结构和样式

1. 定义如下的 UI 结构：

   ```xml
   <!-- 最外层的容器 -->
   <view class="my-settle-container">
     <!-- 全选区域 -->
     <label class="radio">
       <radio color="#C00000" :checked="true" /><text>全选</text>
     </label>
   
     <!-- 合计区域 -->
     <view class="amount-box">
       合计:<text class="amount">￥1234.00</text>
     </view>
   
     <!-- 结算按钮 -->
     <view class="btn-settle">结算(0)</view>
   </view>
   ```

2. 美化样式：

   ```scss
   .my-settle-container {
     position: fixed;
     bottom: 0;
     left: 0;
     width: 100%;
     height: 50px;
     // 将背景色从 cyan 改为 white
     background-color: white;
     display: flex;
     justify-content: space-between;
     align-items: center;
     padding-left: 5px;
     font-size: 14px;
   
     .radio {
       display: flex;
       align-items: center;
     }
   
     .amount {
       color: #c00000;
     }
   
     .btn-settle {
       height: 50px;
       min-width: 100px;
       background-color: #c00000;
       color: white;
       line-height: 50px;
       text-align: center;
       padding: 0 10px;
     }
   }
   ```

##### 3.3 动态渲染已勾选商品的总数量

1. 在 `store/cart.js` 模块中，定义一个名称为 `checkedCount` 的 getters，用来统计已勾选商品的总数量：

   ```js
   // 勾选的商品的总数量
   checkedCount(state) {
     // 先使用 filter 方法，从购物车中过滤器已勾选的商品
     // 再使用 reduce 方法，将已勾选的商品总数量进行累加
     // reduce() 的返回值就是已勾选的商品的总数量
     return state.cart.filter(x => x.goods_state).reduce((total, item) => total += item.goods_count, 0)
   }
   ```

2. 在 `my-settle` 组件中，通过 `mapGetters` 辅助函数，将需要的 getters 映射到当前组件中使用：

   ```js
   import { mapGetters } from 'vuex'
   
   export default {
     computed: {
       ...mapGetters('m_cart', ['checkedCount']),
     },
     data() {
       return {}
     },
   }
   ```

3. 将 `checkedCount` 的值渲染到页面中：

   ```xml
   <!-- 结算按钮 -->
   <view class="btn-settle">结算({{checkedCount}})</view>
   ```

##### 3.4 动态渲染全选按钮的选中状态

1. 使用 `mapGetters` 辅助函数，将**商品的总数量**映射到当前组件中使用，并定义一个叫做 `isFullCheck` 的计

   算属性：

   ```js
   import { mapGetters } from 'vuex'
   
   export default {
     computed: {
       // 1. 将 total 映射到当前组件中
       ...mapGetters('m_cart', ['checkedCount', 'total']),
       // 2. 是否全选
       isFullCheck() {
         return this.total === this.checkedCount
       },
     },
     data() {
       return {}
     },
   }
   ```

2. 为 radio 组件动态绑定 `checked` 属性的值：

   ```xml
   <!-- 全选区域 -->
   <label class="radio">
     <radio color="#C00000" :checked="isFullCheck" /><text>全选</text>
   </label>
   ```

##### 3.5 实现商品的全选/反选功能

1. 在 `store/cart.js` 模块中，定义一个叫做 `updateAllGoodsState` 的 mutations 方法，用来修改所有商品的勾选状态：

   ```js
   // 更新所有商品的勾选状态
   updateAllGoodsState(state, newState) {
     // 循环更新购物车中每件商品的勾选状态
     state.cart.forEach(x => x.goods_state = newState)
     // 持久化存储到本地
     this.commit('m_cart/saveToStorage')
   }
   ```

2. 在 `my-settle` 组件中，通过 `mapMutations` 辅助函数，将需要的 mutations 方法映射到当前组件中使用：

   ```js
   // 1. 按需导入 mapMutations 辅助函数
   import { mapGetters, mapMutations } from 'vuex'
   
   export default {
     // 省略其它代码
     methods: {
       // 2. 使用 mapMutations 辅助函数，把 m_cart 模块提供的 updateAllGoodsState 方法映射到当前组件中使用
       ...mapMutations('m_cart', ['updateAllGoodsState']),
     },
   }
   ```

3. 为 UI 中的 `label` 组件绑定 `click` 事件处理函数：

   ```xml
   <!-- 全选区域 -->
   <label class="radio" @click="changeAllState">
     <radio color="#C00000" :checked="isFullCheck" /><text>全选</text>
   </label>
   ```

4. 在 `my-settle` 组件的 methods 节点中，声明 `changeAllState` 事件处理函数：

   ```js
   methods: {
     ...mapMutations('m_cart', ['updateAllGoodsState']),
     // label 的点击事件处理函数
     changeAllState() {
       // 修改购物车中所有商品的选中状态
       // !this.isFullCheck 表示：当前全选按钮的状态取反之后，就是最新的勾选状态
       this.updateAllGoodsState(!this.isFullCheck)
     }
   }
   ```

##### 3.6 动态渲染已勾选商品的总价格

1. 在 `store/cart.js` 模块中，定义一个叫做 `checkedGoodsAmount` 的 getters，用来统计已勾选商品的总价格：

   ```js
   // 已勾选的商品的总价
   checkedGoodsAmount(state) {
     // 先使用 filter 方法，从购物车中过滤器已勾选的商品
     // 再使用 reduce 方法，将已勾选的商品数量 * 单价之后，进行累加
     // reduce() 的返回值就是已勾选的商品的总价
     // 最后调用 toFixed(2) 方法，保留两位小数
     return state.cart.filter(x => x.goods_state)
                      .reduce((total, item) => total += item.goods_count * item.goods_price, 0)
                      .toFixed(2)
   }
   ```

2. 在 `my-settle` 组件中，使用 `mapGetters` 辅助函数，把需要的 `checkedGoodsAmount` 映射到当前组件中使用：

   ```js
   ...mapGetters('m_cart', ['total', 'checkedCount', 'checkedGoodsAmount'])
   ```

3. 在组件的 UI 结构中，渲染已勾选的商品的总价：

   ```xml
   <!-- 合计区域 -->
   <view class="amount-box">
     合计:<text class="amount">￥{{checkedGoodsAmount}}</text>
   </view>
   ```

##### 3.7 动态计算购物车徽标的数值

1. **问题说明**：当修改购物车中商品的数量之后，tabBar 上的数字徽标不会自动更新。

2. **解决方案**：改造 `mixins/tabbar-badge.js` 中的代码，使用 `watch` 侦听器，监听 `total` 总数量的变化，从

   而动态为 tabBar 的徽标赋值：

   ```js
   import { mapGetters } from 'vuex'
   
   // 导出一个 mixin 对象
   export default {
     computed: {
       ...mapGetters('m_cart', ['total']),
     },
     watch: {
       // 监听 total 值的变化
       total() {
         // 调用 methods 中的 setBadge 方法，重新为 tabBar 的数字徽章赋值
         this.setBadge()
       },
     },
     onShow() {
       // 在页面刚展示的时候，设置数字徽标
       this.setBadge()
     },
     methods: {
       setBadge() {
         // 调用 uni.setTabBarBadge() 方法，为购物车设置右上角的徽标
         uni.setTabBarBadge({
           index: 2,
           text: this.total + '', // 注意：text 的值必须是字符串，不能是数字
         })
       },
     },
   }
   ```

##### 3.8 渲染购物车为空时的页面结构

1. 将 `资料` 目录中的 `cart_empty@2x.png` 图片复制到项目的 `/static/` 目录中

2. 改造 `cart.vue` 页面的 UI 结构，使用 `v-if` 和 `v-else` 控制**购物车区域**和**空白购物车区域**的按需展示：

   ```xml
   <template>
     <view class="cart-container" v-if="cart.length !== 0">
   
       <!-- 使用自定义的 address 组件 -->
   
       <!-- 购物车商品列表的标题区域 -->
   
       <!-- 商品列表区域 -->
   
       <!-- 结算区域 -->
   
     </view>
   
     <!-- 空白购物车区域 -->
     <view class="empty-cart" v-else>
       <image src="/static/cart_empty@2x.png" class="empty-img"></image>
       <text class="tip-text">空空如也~</text>
     </view>
   </template>
   ```

3. 美化空白购物车区域的样式：

   ```scss
   .empty-cart {
     display: flex;
     flex-direction: column;
     align-items: center;
     padding-top: 150px;
   
     .empty-img {
       width: 90px;
       height: 90px;
     }
   
     .tip-text {
       font-size: 12px;
       color: gray;
       margin-top: 15px;
     }
   }
   ```

#### 4、分支的合并与提交

1. 将 `cart` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了购物车的开发"
   ```

2. 将本地的 `cart` 分支推送到码云：

   ```bash
   git push -u origin cart
   ```

3. 将本地 `cart` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge cart
   git push
   ```

4. 删除本地的 `cart` 分支：

   ```bash
   git branch -d cart
   ```

# 登录与支付

#### 1、创建 settle 分支

运行如下的命令，基于 `master` 分支在本地创建 `settle` 子分支，用来开发登录与支付相关的功能：

```bash
git checkout -b settle
```

#### 2、点击结算按钮进行条件判断

> 说明：用户点击了结算按钮之后，需要先后判断**是否勾选了要结算的商品**、**是否选择了收货地址**、**是否登录**。

1. 在 `my-settle` 组件中，为结算按钮绑定点击事件处理函数：

   ```xml
   <!-- 结算按钮 -->
   <view class="btn-settle" @click="settlement">结算({{checkedCount}})</view>
   ```

2. 在 `my-settle` 组件的 methods 节点中声明 settlement 事件处理函数如下：

   ```js
   // 点击了结算按钮
   settlement() {
     // 1. 先判断是否勾选了要结算的商品
     if (!this.checkedCount) return uni.$showMsg('请选择要结算的商品！')
   
     // 2. 再判断用户是否选择了收货地址
     if (!this.addstr) return uni.$showMsg('请选择收货地址！')
   
     // 3. 最后判断用户是否登录了
     if (!this.token) return uni.$showMsg('请先登录！')
   }
   ```

3. 在 `my-settle` 组件中，使用 `mapGetters` 辅助函数，从 `m_user` 模块中将 `addstr` 映射到当前组件中使用：

   ```js
   export default {
     computed: {
       ...mapGetters('m_cart', ['total', 'checkedCount', 'checkedGoodsAmount']),
       // addstr 是详细的收货地址
       ...mapGetters('m_user', ['addstr']),
       isFullCheck() {
         return this.total === this.checkedCount
       },
     },
   }
   ```

4. 在 `store/user.js` 模块的 `state` 节点中，声明 `token` 字符串：

   ```js
   export default {
     // 开启命名空间
     namespaced: true,
   
     // state 数据
     state: () => ({
       // 收货地址
       address: JSON.parse(uni.getStorageSync('address') || '{}'),
       // 登录成功之后的 token 字符串
       token: '',
     }),
   
     // 省略其它代码
   }
   ```

5. 在 `my-settle` 组件中，使用 `mapState` 辅助函数，从 `m_user` 模块中将 `token` 映射到当前组件中使用：

   ```js
   // 按需从 vuex 中导入 mapState 辅助函数
   import { mapGetters, mapMutations, mapState } from 'vuex'
   
   export default {
     computed: {
       ...mapGetters('m_cart', ['total', 'checkedCount', 'checkedGoodsAmount']),
       ...mapGetters('m_user', ['addstr']),
       // token 是用户登录成功之后的 token 字符串
       ...mapState('m_user', ['token']),
       isFullCheck() {
         return this.total === this.checkedCount
       },
     },
   }
   ```

#### 3、登录

##### 3.1 定义 my 页面的编译模式

1. 点击 `微信开发者工具` 工具栏上的编译模式下拉菜单，选择 `添加编译模式`：

   ![img](data:image/png;base64,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)

2. 勾选启动页面的路径之后，点击确定按钮：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/10-4.4d78ed78.png)

##### 3.2 实现登录和用户信息组件的按需展示

1. 在 `components` 目录中新建**登录组件**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/10-1.46e30c32.png)

2. 在 `components` 目录中新建**用户信息组件**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/10-2.ace63114.png)

3. 在 `my.vue` 页面中，通过 `mapState` 辅助函数，导入需要的 `token` 字符串：

   ```js
   import badgeMix from '@/mixins/tabbar-badge.js'
   // 1. 从 vuex 中按需导入 mapState 辅助函数
   import { mapState } from 'vuex'
   
   export default {
     mixins: [badgeMix],
     computed: {
       // 2. 从 m_user 模块中导入需要的 token 字符串
       ...mapState('m_user', ['token']),
     },
     data() {
       return {}
     },
   }
   ```

4. 在 `my.vue` 页面中，实现**登录组件**和**用户信息组件**的按需展示：

   ```xml
   <template>
     <view>
   
       <!-- 用户未登录时，显示登录组件 -->
       <my-login v-if="!token"></my-login>
   
       <!-- 用户登录后，显示用户信息组件 -->
       <my-userinfo v-else></my-userinfo>
   
     </view>
   </template>
   ```

##### 3.3 实现登录组件的基本布局

1. 为 `my-login` 组件定义如下的 UI 结构：

   ```xml
   <template>
     <view class="login-container">
       <!-- 提示登录的图标 -->
       <uni-icons type="contact-filled" size="100" color="#AFAFAF"></uni-icons>
       <!-- 登录按钮 -->
       <button type="primary" class="btn-login">一键登录</button>
       <!-- 登录提示 -->
       <view class="tips-text">登录后尽享更多权益</view>
     </view>
   </template>
   ```

2. 美化登录组件的样式：

   ```scss
   .login-container {
     // 登录盒子的样式
     height: 750rpx;
     display: flex;
     flex-direction: column;
     align-items: center;
     justify-content: center;
     background-color: #f8f8f8;
     position: relative;
     overflow: hidden;
   
     // 绘制登录盒子底部的半椭圆造型
     &::after {
       content: ' ';
       display: block;
       position: absolute;
       width: 100%;
       height: 40px;
       left: 0;
       bottom: 0;
       background-color: white;
       border-radius: 100%;
       transform: translateY(50%);
     }
   
     // 登录按钮的样式
     .btn-login {
       width: 90%;
       border-radius: 100px;
       margin: 15px 0;
       background-color: #c00000;
     }
   
     // 按钮下方提示消息的样式
     .tips-text {
       font-size: 12px;
       color: gray;
     }
   }
   ```

##### 3.4 点击登录按钮获取微信用户的基本信息

> 需求描述：需要获取微信用户的**头像**、**昵称**等基本信息。

1. 为登录的 `button` 按钮绑定 `open-type="getUserInfo"` 属性，表示点击按钮时，希望获取用户的基本信息：

   ```xml
   <!-- 登录按钮 -->
   <!-- 可以从 @getuserinfo 事件处理函数的形参中，获取到用户的基本信息 -->
   <button type="primary" class="btn-login" open-type="getUserInfo" @getuserinfo="getUserInfo">一键登录</button>
   ```

2. 在 `methods` 节点中声明 `getUserInfo` 事件处理函数如下：

   ```js
   methods: {
     // 获取微信用户的基本信息
     getUserInfo(e) {
       // 判断是否获取用户信息成功
       if (e.detail.errMsg === 'getUserInfo:fail auth deny') return uni.$showMsg('您取消了登录授权！')
   
       // 获取用户信息成功， e.detail.userInfo 就是用户的基本信息
       console.log(e.detail.userInfo)
     }
   }
   ```

##### 3.5 将用户的基本信息存储到 vuex

1. 在 `store/user.js` 模块的 state 节点中，声明 `userinfo` 的信息对象如下：

   ```js
   // state 数据
   state: () => ({
     // 收货地址
     // address: {}
     address: JSON.parse(uni.getStorageSync('address') || '{}'),
     // 登录成功之后的 token 字符串
     token: '',
     // 用户的基本信息
     userinfo: JSON.parse(uni.getStorageSync('userinfo') || '{}')
   }),
   ```

2. 在 `store/user.js` 模块的 mutations 节点中，声明如下的两个方法：

   ```js
   // 方法
   mutations: {
     // 省略其它代码...
   
     // 更新用户的基本信息
     updateUserInfo(state, userinfo) {
       state.userinfo = userinfo
       // 通过 this.commit() 方法，调用 m_user 模块下的 saveUserInfoToStorage 方法，将 userinfo 对象持久化存储到本地
       this.commit('m_user/saveUserInfoToStorage')
     },
   
     // 将 userinfo 持久化存储到本地
     saveUserInfoToStorage(state) {
       uni.setStorageSync('userinfo', JSON.stringify(state.userinfo))
     }
   }
   ```

3. 使用 `mapMutations` 辅助函数，将需要的方法映射到 `my-login` 组件中使用：

   ```js
   // 1. 按需导入 mapMutations 辅助函数
   import { mapMutations } from 'vuex'
   
   export default {
     data() {
       return {}
     },
     methods: {
       // 2. 调用 mapMutations 辅助方法，把 m_user 模块中的 updateUserInfo 映射到当前组件中使用
       ...mapMutations('m_user', ['updateUserInfo']),
       // 获取微信用户的基本信息
       getUserInfo(e) {
         // 判断是否获取用户信息成功
         if (e.detail.errMsg === 'getUserInfo:fail auth deny') return uni.$showMsg('您取消了登录授权！')
         // 获取用户信息成功， e.detail.userInfo 就是用户的基本信息
         // console.log(e.detail.userInfo)
   
         // 3. 将用户的基本信息存储到 vuex 中
         this.updateUserInfo(e.detail.userInfo)
       },
     },
   }
   ```

##### 3.6 登录获取 Token 字符串

> 需求说明：当获取到了微信用户的基本信息之后，还需要进一步**调用登录相关的接口**，从而**换取登录成功之后的 Token 字符串**。

1. 在 `getUserInfo` 方法中，预调用 `this.getToken()` 方法，同时把获取到的用户信息传递进去：

   ```js
   // 获取微信用户的基本信息
   getUserInfo(e) {
     // 判断是否获取用户信息成功
     if (e.detail.errMsg === 'getUserInfo:fail auth deny') return uni.$showMsg('您取消了登录授权！')
   
     // 将用户的基本信息存储到 vuex 中
     this.updateUserInfo(e.detail.userInfo)
   
     // 获取登录成功后的 Token 字符串
     this.getToken(e.detail)
   }
   ```

2. 在 `methods` 中定义 `getToken` 方法，调用登录相关的 API，实现登录的功能：

   ```js
   // 调用登录接口，换取永久的 token
   async getToken(info) {
     // 调用微信登录接口
     const [err, res] = await uni.login().catch(err => err)
     // 判断是否 uni.login() 调用失败
     if (err || res.errMsg !== 'login:ok') return uni.$showError('登录失败！')
   
     // 准备参数对象
     const query = {
       code: res.code,
       encryptedData: info.encryptedData,
       iv: info.iv,
       rawData: info.rawData,
       signature: info.signature
     }
   
     // 换取 token
     const { data: loginResult } = await uni.$http.post('/api/public/v1/users/wxlogin', query)
     if (loginResult.meta.status !== 200) return uni.$showMsg('登录失败！')
     uni.$showMsg('登录成功')
   }
   ```

##### 3.7 将 Token 存储到 vuex

1. 在 `store/user.js` 模块的 `mutations` 节点中，声明如下的两个方法：

   ```js
   mutations: {
     // 省略其它代码...
   
     // 更新 token 字符串
     updateToken(state, token) {
       state.token = token
       // 通过 this.commit() 方法，调用 m_user 模块下的 saveTokenToStorage 方法，将 token 字符串持久化存储到本地
       this.commit('m_user/saveTokenToStorage')
     },
   
     // 将 token 字符串持久化存储到本地
     saveTokenToStorage(state) {
       uni.setStorageSync('token', state.token)
     }
   }
   ```

2. 修改 `store/user.js` 模块的 `state` 节点如下：

   ```js
   // state 数据
   state: () => ({
     // 收货地址
     address: JSON.parse(uni.getStorageSync('address') || '{}'),
     // 登录成功之后的 token 字符串
     token: uni.getStorageSync('token') || '',
     // 用户的基本信息
     userinfo: JSON.parse(uni.getStorageSync('userinfo') || '{}')
   }),
   ```

3. 在 `my-login` 组件中，把 vuex 中的 `updateToken` 方法映射到当前组件中使用：

   ```js
   methods: {
     // 1. 使用 mapMutations 辅助方法，把 m_user 模块中的 updateToken 方法映射到当前组件中使用
     ...mapMutations('m_user', ['updateUserInfo', 'updateToken'])
   
     // 省略其它代码...
   
     // 调用登录接口，换取永久的 token
     async getToken(info) {
       // 调用微信登录接口
       const [err, res] = await uni.login().catch(err => err)
       // 判断是否 uni.login() 调用失败
       if (err || res.errMsg !== 'login:ok') return uni.$showError('登录失败！')
   
       // 准备参数对象
       const query = {
         code: res.code,
         encryptedData: info.encryptedData,
         iv: info.iv,
         rawData: info.rawData,
         signature: info.signature
       }
   
       // 换取 token
       const { data: loginResult } = await uni.$http.post('/api/public/v1/users/wxlogin', query)
       if (loginResult.meta.status !== 200) return uni.$showMsg('登录失败！')
   
       // 2. 更新 vuex 中的 token
       this.updateToken(loginResult.message.token)
     }
   }
   ```

#### 4、用户信息

##### 4.1 实现用户头像昵称区域的基本布局

1. 在 `my-userinfo` 组件中，定义如下的 UI 结构：

   ```xml
   <template>
     <view class="my-userinfo-container">
   
       <!-- 头像昵称区域 -->
       <view class="top-box">
         <image src="" class="avatar"></image>
         <view class="nickname">xxx</view>
       </view>
   
     </view>
   </template>
   ```

2. 美化当前组件的样式：

   ```scss
   .my-userinfo-container {
     height: 100%;
     // 为整个组件的结构添加浅灰色的背景
     background-color: #f4f4f4;
   
     .top-box {
       height: 400rpx;
       background-color: #c00000;
       display: flex;
       flex-direction: column;
       align-items: center;
       justify-content: center;
   
       .avatar {
         display: block;
         width: 90px;
         height: 90px;
         border-radius: 45px;
         border: 2px solid white;
         box-shadow: 0 1px 5px black;
       }
   
       .nickname {
         color: white;
         font-weight: bold;
         font-size: 16px;
         margin-top: 10px;
       }
     }
   }
   ```

3. 在 `my.vue` 页面中，为最外层包裹性质的 `view` 容器，添加 `class="my-container"` 的类名，并美化样式如下：

   ```scss
   page,
   .my-container {
     height: 100%;
   }
   ```

##### 4.2 渲染用户的头像和昵称

1. 在 `my-userinfo` 组件中，通过 `mapState` 辅助函数，将需要的成员映射到当前组件中使用：

   ```js
   // 按需导入 mapState 辅助函数
   import { mapState } from 'vuex'
   
   export default {
     computed: {
       // 将 m_user 模块中的 userinfo 映射到当前页面中使用
       ...mapState('m_user', ['userinfo']),
     },
     data() {
       return {}
     },
   }
   ```

2. 将用户的头像和昵称渲染到页面中：

   ```xml
   <!-- 头像昵称区域 -->
   <view class="top-box">
     <image :src="userinfo.avatarUrl" class="avatar"></image>
     <view class="nickname">{{userinfo.nickName}}</view>
   </view>
   ```

##### 4.3 渲染第一个面板区域

1. 在 `my-userinfo` 组件中，定义如下的 UI 结构：

   ```xml
   <!-- 面板的列表区域 -->
   <view class="panel-list">
     <!-- 第一个面板 -->
     <view class="panel">
       <!-- panel 的主体区域 -->
       <view class="panel-body">
         <!-- panel 的 item 项 -->
         <view class="panel-item">
           <text>8</text>
           <text>收藏的店铺</text>
         </view>
         <view class="panel-item">
           <text>14</text>
           <text>收藏的商品</text>
         </view>
         <view class="panel-item">
           <text>18</text>
           <text>关注的商品</text>
         </view>
         <view class="panel-item">
           <text>84</text>
           <text>足迹</text>
         </view>
       </view>
     </view>
   
     <!-- 第二个面板 -->
   
     <!-- 第三个面板 -->
   </view>
   ```

2. 美化第一个面板的样式：

   ```scss
   .panel-list {
     padding: 0 10px;
     position: relative;
     top: -10px;
   
     .panel {
       background-color: white;
       border-radius: 3px;
       margin-bottom: 8px;
   
       .panel-body {
         display: flex;
         justify-content: space-around;
   
         .panel-item {
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: space-around;
           font-size: 13px;
           padding: 10px 0;
         }
       }
     }
   }
   ```

##### 4.4  渲染第二个面板区域

1. 定义第二个面板区域的 UI 结构：

   ```xml
   <!-- 第二个面板 -->
   <view class="panel">
     <!-- 面板的标题 -->
     <view class="panel-title">我的订单</view>
     <!-- 面板的主体 -->
     <view class="panel-body">
       <!-- 面板主体中的 item 项 -->
       <view class="panel-item">
         <image src="/static/my-icons/icon1.png" class="icon"></image>
         <text>待付款</text>
       </view>
       <view class="panel-item">
         <image src="/static/my-icons/icon2.png" class="icon"></image>
         <text>待收货</text>
       </view>
       <view class="panel-item">
         <image src="/static/my-icons/icon3.png" class="icon"></image>
         <text>退款/退货</text>
       </view>
       <view class="panel-item">
         <image src="/static/my-icons/icon4.png" class="icon"></image>
         <text>全部订单</text>
       </view>
     </view>
   </view>
   ```

2. 对之前的 SCSS 样式进行改造，从而美化第二个面板的样式：

   ```scss
   .panel-list {
     padding: 0 10px;
     position: relative;
     top: -10px;
   
     .panel {
       background-color: white;
       border-radius: 3px;
       margin-bottom: 8px;
   
       .panel-title {
         line-height: 45px;
         padding-left: 10px;
         font-size: 15px;
         border-bottom: 1px solid #f4f4f4;
       }
   
       .panel-body {
         display: flex;
         justify-content: space-around;
   
         .panel-item {
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: space-around;
           font-size: 13px;
           padding: 10px 0;
   
           .icon {
             width: 35px;
             height: 35px;
           }
         }
       }
     }
   }
   ```

##### 4.5 渲染第三个面板区域

1. 定义第三个面板区域的 UI 结构：

   ```xml
   <!-- 第三个面板 -->
   <view class="panel">
     <view class="panel-list-item">
       <text>收货地址</text>
       <uni-icons type="arrowright" size="15"></uni-icons>
     </view>
     <view class="panel-list-item">
       <text>联系客服</text>
       <uni-icons type="arrowright" size="15"></uni-icons>
     </view>
     <view class="panel-list-item">
       <text>退出登录</text>
       <uni-icons type="arrowright" size="15"></uni-icons>
     </view>
   </view>
   ```

2. 美化第三个面板区域的样式：

   ```scss
   .panel-list-item {
     height: 45px;
     display: flex;
     justify-content: space-between;
     align-items: center;
     font-size: 15px;
     padding: 0 10px;
   }
   ```

##### 4.6 实现退出登录的功能

1. 为第三个面板区域中的 `退出登录` 项绑定 `click` 点击事件处理函数：

   ```xml
   <view class="panel-list-item" @click="logout">
     <text>退出登录</text>
     <uni-icons type="arrowright" size="15"></uni-icons>
   </view>
   ```

2. 在 `my-userinfo` 组件的 `methods` 节点中定义 `logout` 事件处理函数：

   ```js
   // 退出登录
   async logout() {
     // 询问用户是否退出登录
     const [err, succ] = await uni.showModal({
       title: '提示',
       content: '确认退出登录吗？'
     }).catch(err => err)
   
     if (succ && succ.confirm) {
        // 用户确认了退出登录的操作
        // 需要清空 vuex 中的 userinfo、token 和 address
        this.updateUserInfo({})
        this.updateToken('')
        this.updateAddress({})
     }
   }
   ```

3. 使用 `mapMutations` 辅助方法，将需要用到的 mutations 方法映射到当前组件中：

   ```js
   // 按需导入辅助函数
   import { mapState, mapMutations } from 'vuex'
   
   export default {
     methods: {
       ...mapMutations('m_user', ['updateUserInfo', 'updateToken', 'updateAddress']),
     },
   }
   ```

#### 5、三秒后自动跳转

##### 5.1 三秒后自动跳转到登录页面

> 需求描述：在购物车页面，当用户点击 “结算” 按钮时，**如果用户没有登录，则 3 秒后自动跳转到登录页面**

1. 在 `my-settle` 组件的 `methods` 节点中，声明一个叫做 `showTips` 的方法，专门用来展示倒计时的提示消息：

   ```js
   // 展示倒计时的提示消息
   showTips(n) {
     // 调用 uni.showToast() 方法，展示提示消息
     uni.showToast({
       // 不展示任何图标
       icon: 'none',
       // 提示的消息
       title: '请登录后再结算！' + n + ' 秒后自动跳转到登录页',
       // 为页面添加透明遮罩，防止点击穿透
       mask: true,
       // 1.5 秒后自动消失
       duration: 1500
     })
   }
   ```

2. 在 `data` 节点中声明倒计时的秒数：

   ```js
   data() {
     return {
       // 倒计时的秒数
       seconds: 3
     }
   }
   ```

3. 改造 `结算` 按钮的 `click` 事件处理函数，如果用户没有登录，则**预调用**一个叫做 `delayNavigate` 的方法，

   进行倒计时的导航跳转：

   ```js
   // 点击了结算按钮
   settlement() {
     // 1. 先判断是否勾选了要结算的商品
     if (!this.checkedCount) return uni.$showMsg('请选择要结算的商品！')
   
     // 2. 再判断用户是否选择了收货地址
     if (!this.addstr) return uni.$showMsg('请选择收货地址！')
   
     // 3. 最后判断用户是否登录了，如果没有登录，则调用 delayNavigate() 进行倒计时的导航跳转
     // if (!this.token) return uni.$showMsg('请先登录！')
     if (!this.token) return this.delayNavigate()
   },
   ```

4. 定义 `delayNavigate` 方法，初步实现**倒计时的提示功能**：

   ```js
   // 延迟导航到 my 页面
   delayNavigate() {
     // 1. 展示提示消息，此时 seconds 的值等于 3
     this.showTips(this.seconds)
   
     // 2. 创建定时器，每隔 1 秒执行一次
     setInterval(() => {
       // 2.1 先让秒数自减 1
       this.seconds--
       // 2.2 再根据最新的秒数，进行消息提示
       this.showTips(this.seconds)
     }, 1000)
   },
   ```

   > 上述代码的问题：**定时器不会自动停止**，此时秒数会出现等于 0 或小于 0 的情况！

5. 在 `data` 节点中声明定时器的 Id 如下：

   ```js
   data() {
     return {
       // 倒计时的秒数
       seconds: 3,
       // 定时器的 Id
       timer: null
     }
   }
   ```

6. 改造 `delayNavigate` 方法如下：

   ```js
   // 延迟导航到 my 页面
   delayNavigate() {
     this.showTips(this.seconds)
   
     // 1. 将定时器的 Id 存储到 timer 中
     this.timer = setInterval(() => {
       this.seconds--
   
       // 2. 判断秒数是否 <= 0
       if (this.seconds <= 0) {
         // 2.1 清除定时器
         clearInterval(this.timer)
   
         // 2.2 跳转到 my 页面
         uni.switchTab({
           url: '/pages/my/my'
         })
   
         // 2.3 终止后续代码的运行（当秒数为 0 时，不再展示 toast 提示消息）
         return
       }
   
       this.showTips(this.seconds)
     }, 1000)
   },
   ```

   > 上述代码的问题：**seconds 秒数不会被重置**，导致第 2 次，3 次，n 次 的倒计时跳转功能无法正常工作

7. 进一步改造 `delayNavigate` 方法，在执行此方法时，立即将 `seconds` 秒数重置为 `3` 即可：

   ```js
   // 延迟导航到 my 页面
   delayNavigate() {
     // 把 data 中的秒数重置成 3 秒
     this.seconds = 3
     this.showTips(this.seconds)
   
     this.timer = setInterval(() => {
       this.seconds--
   
       if (this.seconds <= 0) {
         clearInterval(this.timer)
         uni.switchTab({
           url: '/pages/my/my'
         })
         return
       }
   
       this.showTips(this.seconds)
     }, 1000)
   }
   ```

##### 5.2 登录成功之后再返回之前的页面

> 核心实现思路：在自动跳转到登录页面成功之后，把**返回页面的信息存储到 vuex 中**，从而方便登录成功之后，根据返回页面的信息重新跳转回去。

> 返回页面的信息对象，**主要包含 { openType, from } 两个属性**，其中 openType 表示**以哪种方式导航回之前的页面**；from 表示**之前页面的 url 地址**；

1. 在 `store/user.js` 模块的 `state` 节点中，声明一个叫做 `redirectInfo` 的对象如下：

   ```js
   // state 数据
   state: () => ({
     // 收货地址
     address: JSON.parse(uni.getStorageSync('address') || '{}'),
     // 登录成功之后的 token 字符串
     token: uni.getStorageSync('token') || '',
     // 用户的基本信息
     userinfo: JSON.parse(uni.getStorageSync('userinfo') || '{}'),
     // 重定向的 object 对象 { openType, from }
     redirectInfo: null
   }),
   ```

2. 在 `store/user.js` 模块的 `mutations` 节点中，声明一个叫做 `updateRedirectInfo` 的方法：

   ```js
   mutations: {
     // 更新重定向的信息对象
     updateRedirectInfo(state, info) {
       state.redirectInfo = info
     }
   }
   ```

3. 在 `my-settle` 组件中，通过 `mapMutations` 辅助方法，把 `m_user` 模块中的 `updateRedirectInfo` 方法映射到当前页面中使用：

   ```js
   methods: {
     // 把 m_user 模块中的 updateRedirectInfo 方法映射到当前页面中使用
     ...mapMutations('m_user', ['updateRedirectInfo']),
   }
   ```

4. 改造 `my-settle` 组件 methods 节点中的 `delayNavigate` 方法，当成功跳转到 `my 页面` 之后，将重定向的信息对象存储到 vuex 中：

   ```js
   // 延迟导航到 my 页面
   delayNavigate() {
     // 把 data 中的秒数重置成 3 秒
     this.seconds = 3
     this.showTips(this.seconds)
   
     this.timer = setInterval(() => {
       this.seconds--
   
       if (this.seconds <= 0) {
         // 清除定时器
         clearInterval(this.timer)
         // 跳转到 my 页面
         uni.switchTab({
           url: '/pages/my/my',
           // 页面跳转成功之后的回调函数
           success: () => {
             // 调用 vuex 的 updateRedirectInfo 方法，把跳转信息存储到 Store 中
             this.updateRedirectInfo({
               // 跳转的方式
               openType: 'switchTab',
               // 从哪个页面跳转过去的
               from: '/pages/cart/cart'
             })
           }
         })
   
         return
       }
   
       this.showTips(this.seconds)
     }, 1000)
   }
   ```

5. 在 `my-login` 组件中，通过 `mapState` 和 `mapMutations` 辅助方法，将 vuex 中需要的数据和方法，映射到当前页面中使用：

   ```js
   // 按需导入辅助函数
   import { mapMutations, mapState } from 'vuex'
   
   export default {
     computed: {
       // 调用 mapState 辅助方法，把 m_user 模块中的数据映射到当前用组件中使用
       ...mapState('m_user', ['redirectInfo']),
     },
     methods: {
       // 调用 mapMutations 辅助方法，把 m_user 模块中的方法映射到当前组件中使用
       ...mapMutations('m_user', ['updateUserInfo', 'updateToken', 'updateRedirectInfo']),
     },
   }
   ```

6. 改造 `my-login` 组件中的 `getToken` 方法，当登录成功之后，预调用 `this.navigateBack()` 方法返回登录之前的页面：

   ```js
   // 调用登录接口，换取永久的 token
   async getToken(info) {
     // 省略其它代码...
   
     // 判断 vuex 中的 redirectInfo 是否为 null
     // 如果不为 null，则登录成功之后，需要重新导航到对应的页面
     this.navigateBack()
   }
   ```

7. 在 `my-login` 组件中，声明 `navigateBack` 方法如下：

   ```js
   // 返回登录之前的页面
   navigateBack() {
     // redirectInfo 不为 null，并且导航方式为 switchTab
     if (this.redirectInfo && this.redirectInfo.openType === 'switchTab') {
       // 调用小程序提供的 uni.switchTab() API 进行页面的导航
       uni.switchTab({
         // 要导航到的页面地址
         url: this.redirectInfo.from,
         // 导航成功之后，把 vuex 中的 redirectInfo 对象重置为 null
         complete: () => {
           this.updateRedirectInfo(null)
         }
       })
     }
   }
   ```

#### 6、微信支付

##### 6.1 在请求头中添加 Token 身份认证的字段

1. 原因说明：**只有在登录之后才允许调用支付相关的接口**，所以必须为有权限的接口添加身份认证的请求头字段

2. 打开项目根目录下的 `main.js`，改造 `$http.beforeRequest` 请求拦截器中的代码如下：

   ```js
   // 请求开始之前做一些事情
   $http.beforeRequest = function(options) {
     uni.showLoading({
       title: '数据加载中...',
     })
   
     // 判断请求的是否为有权限的 API 接口
     if (options.url.indexOf('/my/') !== -1) {
       // 为请求头添加身份认证字段
       options.header = {
         // 字段的值可以直接从 vuex 中进行获取
         Authorization: store.state.m_user.token,
       }
     }
   }
   ```

##### 6.2 微信支付的流程

1. **创建订单**
   - 请求创建订单的 API 接口：把（订单金额、收货地址、订单中包含的商品信息）发送到服务器
   - 服务器响应的结果：*订单编号*
2. **订单预支付**
   - 请求订单预支付的 API 接口：把（订单编号）发送到服务器
   - 服务器响应的结果：*订单预支付的参数对象*，里面包含了订单支付相关的必要参数
3. **发起微信支付**
   - 调用 `uni.requestPayment()` 这个 API，发起微信支付；把步骤 2 得到的 “订单预支付对象” 作为参数传递给 `uni.requestPayment()` 方法
   - 监听 `uni.requestPayment()` 这个 API 的 `success`，`fail`，`complete` 回调函数

##### 6.3 创建订单

1. 改造 `my-settle` 组件中的 `settlement` 方法，当前三个判断条件通过之后，调用实现微信支付的方法：

   ```js
   // 点击了结算按钮
   settlement() {
     // 1. 先判断是否勾选了要结算的商品
     if (!this.checkedCount) return uni.$showMsg('请选择要结算的商品！')
   
     // 2. 再判断用户是否选择了收货地址
     if (!this.addstr) return uni.$showMsg('请选择收货地址！')
   
     // 3. 最后判断用户是否登录了
     // if (!this.token) return uni.$showMsg('请先登录！')
     if (!this.token) return this.delayNavigate()
   
     // 4. 实现微信支付功能
     this.payOrder()
   },
   ```

2. 在 `my-settle` 组件中定义 `payOrder` 方法如下，先实现创建订单的功能：

   ```js
   // 微信支付
   async payOrder() {
     // 1. 创建订单
     // 1.1 组织订单的信息对象
     const orderInfo = {
       // 开发期间，注释掉真实的订单价格，
       // order_price: this.checkedGoodsAmount,
       // 写死订单总价为 1 分钱
       order_price: 0.01,
       consignee_addr: this.addstr,
       goods: this.cart.filter(x => x.goods_state).map(x => ({ goods_id: x.goods_id, goods_number: x.goods_count, goods_price: x.goods_price }))
     }
     // 1.2 发起请求创建订单
     const { data: res } = await uni.$http.post('/api/public/v1/my/orders/create', orderInfo)
     if (res.meta.status !== 200) return uni.$showMsg('创建订单失败！')
     // 1.3 得到服务器响应的“订单编号”
     const orderNumber = res.message.order_number
   
      // 2. 订单预支付
   
      // 3. 发起微信支付
    }
   ```

##### 6.4 订单预支付

改造 `my-settle` 组件的 `payOrder` 方法，实现订单预支付功能：

```js
// 微信支付
async payOrder() {
  // 1. 创建订单
  // 1.1 组织订单的信息对象
  const orderInfo = {
    // 开发期间，注释掉真实的订单价格，
    // order_price: this.checkedGoodsAmount,
    // 写死订单总价为 1 分钱
    order_price: 0.01,
    consignee_addr: this.addstr,
    goods: this.cart.filter(x => x.goods_state).map(x => ({ goods_id: x.goods_id, goods_number: x.goods_count, goods_price: x.goods_price }))
  }
  // 1.2 发起请求创建订单
  const { data: res } = await uni.$http.post('/api/public/v1/my/orders/create', orderInfo)
  if (res.meta.status !== 200) return uni.$showMsg('创建订单失败！')
  // 1.3 得到服务器响应的“订单编号”
  const orderNumber = res.message.order_number

  // 2. 订单预支付
  // 2.1 发起请求获取订单的支付信息
  const { data: res2 } = await uni.$http.post('/api/public/v1/my/orders/req_unifiedorder', { order_number: orderNumber })
  // 2.2 预付订单生成失败
  if (res2.meta.status !== 200) return uni.$showError('预付订单生成失败！')
  // 2.3 得到订单支付相关的必要参数
  const payInfo = res2.message.pay

   // 3. 发起微信支付
 }
```

##### 6.5 发起微信支付

改造 `my-settle` 组件的 `payOrder` 方法，实现微信支付的功能：

```js
// 微信支付
async payOrder() {
  // 1. 创建订单
  // 1.1 组织订单的信息对象
  const orderInfo = {
    // 开发期间，注释掉真实的订单价格，
    // order_price: this.checkedGoodsAmount,
    // 写死订单总价为 1 分钱
    order_price: 0.01,
    consignee_addr: this.addstr,
    goods: this.cart.filter(x => x.goods_state).map(x => ({ goods_id: x.goods_id, goods_number: x.goods_count, goods_price: x.goods_price }))
  }
  // 1.2 发起请求创建订单
  const { data: res } = await uni.$http.post('/api/public/v1/my/orders/create', orderInfo)
  if (res.meta.status !== 200) return uni.$showMsg('创建订单失败！')
  // 1.3 得到服务器响应的“订单编号”
  const orderNumber = res.message.order_number

   // 2. 订单预支付
   // 2.1 发起请求获取订单的支付信息
   const { data: res2 } = await uni.$http.post('/api/public/v1/my/orders/req_unifiedorder', { order_number: orderNumber })
   // 2.2 预付订单生成失败
   if (res2.meta.status !== 200) return uni.$showError('预付订单生成失败！')
   // 2.3 得到订单支付相关的必要参数
   const payInfo = res2.message.pay

   // 3. 发起微信支付
   // 3.1 调用 uni.requestPayment() 发起微信支付
   const [err, succ] = await uni.requestPayment(payInfo)
   // 3.2 未完成支付
   if (err) return uni.$showMsg('订单未支付！')
   // 3.3 完成了支付，进一步查询支付的结果
   const { data: res3 } = await uni.$http.post('/api/public/v1/my/orders/chkOrder', { order_number: orderNumber })
   // 3.4 检测到订单未支付
   if (res3.meta.status !== 200) return uni.$showMsg('订单未支付！')
   // 3.5 检测到订单支付完成
   uni.showToast({
     title: '支付完成！',
     icon: 'success'
   })
 }
```

#### 7、分支的提交与合并

1. 将 `settle` 分支进行本地提交：

   ```bash
   git add .
   git commit -m "完成了登录和支付功能的开发"
   ```

2. 将本地的 `settle` 分支推送到码云：

   ```bash
   git push -u origin settle
   ```

3. 将本地 `settle` 分支中的代码合并到 `master` 分支：

   ```bash
   git checkout master
   git merge settle
   git push
   ```

4. 删除本地的 `settle` 分支：

   ```bash
   git branch -d settle
   ```

# 发布

#### 1、为什么要发布

1. 小程序只有发布之后，才能被用户搜索并使用
2. 开发期间的小程序为了便于调试，含有 sourcemap 相关的文件，并且代码没有被压缩，因此体积较大，不适合直接当作线上版本进行发布
3. 通过执行 “小程序发布”，能够优化小程序的体积，提高小程序的运行性能

#### 2、发布小程序的流程

1. 点击 `HBuilderX` 菜单栏上的 `发行` -> `小程序-微信(仅适用于uni-app)`：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-1.9cdf19c7.png)

2. 在弹出框中填写要发布的**小程序的名称**和**AppId**之后，点击发行按钮：

   ![img](data:image/png;base64,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)

3. 在 `HBuilderX` 的控制台中**查看小程序发布编译的进度**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-3.567c1979.png)

4. 发布编译完成之后，会自动打开一个新的**微信开发者工具界面**，此时，点击工具栏上的上传按钮：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-4.9c24f0ee.png)

5. 填写**版本号**和**项目备注**之后，点击**上传**按钮：

   ![img](data:image/png;base64,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)

6. 上传完成之后，会出现如下的提示消息，直接点击**确定**按钮即可：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-6.d5c408c3.png)

7. 通过微信开发者工具上传的代码，默认处于**版本管理**的**开发版本**列表中，如图所示：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-7.ec9045bc.png)

8. 将 `开发版本提交审核` -> 再将 `审核通过的版本发布上线`，即可实现小程序的发布和上线：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-8.a251f8b8.png)

#### 3、发布为 Android App 的流程

1. 点击 HBuilderX 状态栏左侧的**未登录**按钮，弹出登录的对话框：

   ![img](data:image/png;base64,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)

2. 在弹出的登录对话框中，填写**账号**和**密码**之后，**点击登录**即可：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-10.438598e0.png)

3. 打开项目根目录中的 `manifest.json` 配置文件，在**基础配置**面板中，获取**uni-app 应用标识**，并填写**应用名称**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-11.dc32f303.png)

4. 切换到 **App 图标配置**面板，点击**浏览**按钮，选择合适的图片之后，再点击**自动生成所有图标并替换**即可：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-12.e3157064.png)

5. 点击菜单栏上的 **发行** -> **原生 App-云打包**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-13.d176ba65.png)

6. **勾选打包配置**如下：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-14.ddd7bcc3.png)

7. 在**控制台**中**查看打包的进度信息**：

   ![img](https://www.escook.cn/docs-uni-shop/assets/img/11-15.c8d3b328.png)

8. 点击链接**下载 apk 的安装包**，并**安装到 Android 手机中**查看打包的效果。

> 注意：由于开发期间**没有进行多端适配**，所以有些功能在 App 中无法正常运行，例如：**选择收货地址**、**微信登录**、**微信支付**